{"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/index.ts":{"path":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/index.ts","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":11,"column":3}},"2":{"start":{"line":9,"column":4},"end":{"line":9,"column":38}},"3":{"start":{"line":12,"column":0},"end":{"line":17,"column":3}},"4":{"start":{"line":15,"column":4},"end":{"line":15,"column":32}},"5":{"start":{"line":18,"column":0},"end":{"line":23,"column":3}},"6":{"start":{"line":21,"column":4},"end":{"line":21,"column":35}},"7":{"start":{"line":24,"column":0},"end":{"line":29,"column":3}},"8":{"start":{"line":27,"column":4},"end":{"line":27,"column":38}},"9":{"start":{"line":30,"column":0},"end":{"line":35,"column":3}},"10":{"start":{"line":33,"column":4},"end":{"line":33,"column":34}},"11":{"start":{"line":36,"column":0},"end":{"line":41,"column":3}},"12":{"start":{"line":39,"column":4},"end":{"line":39,"column":35}},"13":{"start":{"line":42,"column":0},"end":{"line":47,"column":3}},"14":{"start":{"line":45,"column":4},"end":{"line":45,"column":35}},"15":{"start":{"line":48,"column":0},"end":{"line":53,"column":3}},"16":{"start":{"line":51,"column":4},"end":{"line":51,"column":38}},"17":{"start":{"line":54,"column":0},"end":{"line":59,"column":3}},"18":{"start":{"line":57,"column":4},"end":{"line":57,"column":36}},"19":{"start":{"line":60,"column":0},"end":{"line":65,"column":3}},"20":{"start":{"line":63,"column":4},"end":{"line":63,"column":34}},"21":{"start":{"line":66,"column":0},"end":{"line":71,"column":3}},"22":{"start":{"line":69,"column":4},"end":{"line":69,"column":35}},"23":{"start":{"line":72,"column":0},"end":{"line":77,"column":3}},"24":{"start":{"line":75,"column":4},"end":{"line":75,"column":34}},"25":{"start":{"line":78,"column":0},"end":{"line":83,"column":3}},"26":{"start":{"line":81,"column":4},"end":{"line":81,"column":25}},"27":{"start":{"line":84,"column":0},"end":{"line":89,"column":3}},"28":{"start":{"line":87,"column":4},"end":{"line":87,"column":36}},"29":{"start":{"line":90,"column":0},"end":{"line":95,"column":3}},"30":{"start":{"line":93,"column":4},"end":{"line":93,"column":40}},"31":{"start":{"line":96,"column":0},"end":{"line":101,"column":3}},"32":{"start":{"line":99,"column":4},"end":{"line":99,"column":42}},"33":{"start":{"line":102,"column":0},"end":{"line":107,"column":3}},"34":{"start":{"line":105,"column":4},"end":{"line":105,"column":40}},"35":{"start":{"line":108,"column":0},"end":{"line":113,"column":3}},"36":{"start":{"line":111,"column":4},"end":{"line":111,"column":44}},"37":{"start":{"line":114,"column":0},"end":{"line":119,"column":3}},"38":{"start":{"line":117,"column":4},"end":{"line":117,"column":32}},"39":{"start":{"line":120,"column":0},"end":{"line":125,"column":3}},"40":{"start":{"line":123,"column":4},"end":{"line":123,"column":40}},"41":{"start":{"line":126,"column":0},"end":{"line":131,"column":3}},"42":{"start":{"line":129,"column":4},"end":{"line":129,"column":36}},"43":{"start":{"line":132,"column":0},"end":{"line":137,"column":3}},"44":{"start":{"line":135,"column":4},"end":{"line":135,"column":41}},"45":{"start":{"line":138,"column":0},"end":{"line":143,"column":3}},"46":{"start":{"line":141,"column":4},"end":{"line":141,"column":37}},"47":{"start":{"line":144,"column":0},"end":{"line":149,"column":3}},"48":{"start":{"line":147,"column":4},"end":{"line":147,"column":38}},"49":{"start":{"line":150,"column":0},"end":{"line":155,"column":3}},"50":{"start":{"line":153,"column":4},"end":{"line":153,"column":32}},"51":{"start":{"line":156,"column":0},"end":{"line":161,"column":3}},"52":{"start":{"line":159,"column":4},"end":{"line":159,"column":36}},"53":{"start":{"line":162,"column":0},"end":{"line":167,"column":3}},"54":{"start":{"line":165,"column":4},"end":{"line":165,"column":34}},"55":{"start":{"line":168,"column":0},"end":{"line":173,"column":3}},"56":{"start":{"line":171,"column":4},"end":{"line":171,"column":36}},"57":{"start":{"line":174,"column":0},"end":{"line":179,"column":3}},"58":{"start":{"line":177,"column":4},"end":{"line":177,"column":38}},"59":{"start":{"line":181,"column":16},"end":{"line":181,"column":37}},"60":{"start":{"line":183,"column":12},"end":{"line":183,"column":29}},"61":{"start":{"line":185,"column":15},"end":{"line":185,"column":35}},"62":{"start":{"line":187,"column":15},"end":{"line":187,"column":35}},"63":{"start":{"line":189,"column":12},"end":{"line":189,"column":29}},"64":{"start":{"line":191,"column":16},"end":{"line":191,"column":37}}},"fnMap":{"0":{"name":"get","decl":{"start":{"line":8,"column":16},"end":{"line":8,"column":19}},"loc":{"start":{"line":8,"column":22},"end":{"line":10,"column":3}},"line":8},"1":{"name":"get","decl":{"start":{"line":14,"column":16},"end":{"line":14,"column":19}},"loc":{"start":{"line":14,"column":22},"end":{"line":16,"column":3}},"line":14},"2":{"name":"get","decl":{"start":{"line":20,"column":16},"end":{"line":20,"column":19}},"loc":{"start":{"line":20,"column":22},"end":{"line":22,"column":3}},"line":20},"3":{"name":"get","decl":{"start":{"line":26,"column":16},"end":{"line":26,"column":19}},"loc":{"start":{"line":26,"column":22},"end":{"line":28,"column":3}},"line":26},"4":{"name":"get","decl":{"start":{"line":32,"column":16},"end":{"line":32,"column":19}},"loc":{"start":{"line":32,"column":22},"end":{"line":34,"column":3}},"line":32},"5":{"name":"get","decl":{"start":{"line":38,"column":16},"end":{"line":38,"column":19}},"loc":{"start":{"line":38,"column":22},"end":{"line":40,"column":3}},"line":38},"6":{"name":"get","decl":{"start":{"line":44,"column":16},"end":{"line":44,"column":19}},"loc":{"start":{"line":44,"column":22},"end":{"line":46,"column":3}},"line":44},"7":{"name":"get","decl":{"start":{"line":50,"column":16},"end":{"line":50,"column":19}},"loc":{"start":{"line":50,"column":22},"end":{"line":52,"column":3}},"line":50},"8":{"name":"get","decl":{"start":{"line":56,"column":16},"end":{"line":56,"column":19}},"loc":{"start":{"line":56,"column":22},"end":{"line":58,"column":3}},"line":56},"9":{"name":"get","decl":{"start":{"line":62,"column":16},"end":{"line":62,"column":19}},"loc":{"start":{"line":62,"column":22},"end":{"line":64,"column":3}},"line":62},"10":{"name":"get","decl":{"start":{"line":68,"column":16},"end":{"line":68,"column":19}},"loc":{"start":{"line":68,"column":22},"end":{"line":70,"column":3}},"line":68},"11":{"name":"get","decl":{"start":{"line":74,"column":16},"end":{"line":74,"column":19}},"loc":{"start":{"line":74,"column":22},"end":{"line":76,"column":3}},"line":74},"12":{"name":"get","decl":{"start":{"line":80,"column":16},"end":{"line":80,"column":19}},"loc":{"start":{"line":80,"column":22},"end":{"line":82,"column":3}},"line":80},"13":{"name":"get","decl":{"start":{"line":86,"column":16},"end":{"line":86,"column":19}},"loc":{"start":{"line":86,"column":22},"end":{"line":88,"column":3}},"line":86},"14":{"name":"get","decl":{"start":{"line":92,"column":16},"end":{"line":92,"column":19}},"loc":{"start":{"line":92,"column":22},"end":{"line":94,"column":3}},"line":92},"15":{"name":"get","decl":{"start":{"line":98,"column":16},"end":{"line":98,"column":19}},"loc":{"start":{"line":98,"column":22},"end":{"line":100,"column":3}},"line":98},"16":{"name":"get","decl":{"start":{"line":104,"column":16},"end":{"line":104,"column":19}},"loc":{"start":{"line":104,"column":22},"end":{"line":106,"column":3}},"line":104},"17":{"name":"get","decl":{"start":{"line":110,"column":16},"end":{"line":110,"column":19}},"loc":{"start":{"line":110,"column":22},"end":{"line":112,"column":3}},"line":110},"18":{"name":"get","decl":{"start":{"line":116,"column":16},"end":{"line":116,"column":19}},"loc":{"start":{"line":116,"column":22},"end":{"line":118,"column":3}},"line":116},"19":{"name":"get","decl":{"start":{"line":122,"column":16},"end":{"line":122,"column":19}},"loc":{"start":{"line":122,"column":22},"end":{"line":124,"column":3}},"line":122},"20":{"name":"get","decl":{"start":{"line":128,"column":16},"end":{"line":128,"column":19}},"loc":{"start":{"line":128,"column":22},"end":{"line":130,"column":3}},"line":128},"21":{"name":"get","decl":{"start":{"line":134,"column":16},"end":{"line":134,"column":19}},"loc":{"start":{"line":134,"column":22},"end":{"line":136,"column":3}},"line":134},"22":{"name":"get","decl":{"start":{"line":140,"column":16},"end":{"line":140,"column":19}},"loc":{"start":{"line":140,"column":22},"end":{"line":142,"column":3}},"line":140},"23":{"name":"get","decl":{"start":{"line":146,"column":16},"end":{"line":146,"column":19}},"loc":{"start":{"line":146,"column":22},"end":{"line":148,"column":3}},"line":146},"24":{"name":"get","decl":{"start":{"line":152,"column":16},"end":{"line":152,"column":19}},"loc":{"start":{"line":152,"column":22},"end":{"line":154,"column":3}},"line":152},"25":{"name":"get","decl":{"start":{"line":158,"column":16},"end":{"line":158,"column":19}},"loc":{"start":{"line":158,"column":22},"end":{"line":160,"column":3}},"line":158},"26":{"name":"get","decl":{"start":{"line":164,"column":16},"end":{"line":164,"column":19}},"loc":{"start":{"line":164,"column":22},"end":{"line":166,"column":3}},"line":164},"27":{"name":"get","decl":{"start":{"line":170,"column":16},"end":{"line":170,"column":19}},"loc":{"start":{"line":170,"column":22},"end":{"line":172,"column":3}},"line":170},"28":{"name":"get","decl":{"start":{"line":176,"column":16},"end":{"line":176,"column":19}},"loc":{"start":{"line":176,"column":22},"end":{"line":178,"column":3}},"line":176}},"branchMap":{},"s":{"0":1,"1":1,"2":0,"3":1,"4":5,"5":1,"6":0,"7":1,"8":3,"9":1,"10":0,"11":1,"12":3,"13":1,"14":2,"15":1,"16":2,"17":1,"18":0,"19":1,"20":0,"21":1,"22":2,"23":1,"24":1,"25":1,"26":0,"27":1,"28":21,"29":1,"30":0,"31":1,"32":8,"33":1,"34":8,"35":1,"36":2,"37":1,"38":1,"39":1,"40":4,"41":1,"42":4,"43":1,"44":1,"45":1,"46":3,"47":1,"48":3,"49":1,"50":1,"51":1,"52":2,"53":1,"54":2,"55":1,"56":2,"57":1,"58":2,"59":1,"60":1,"61":1,"62":1,"63":1,"64":1},"f":{"0":0,"1":5,"2":0,"3":3,"4":0,"5":3,"6":2,"7":2,"8":0,"9":0,"10":2,"11":1,"12":0,"13":21,"14":0,"15":8,"16":8,"17":2,"18":1,"19":4,"20":4,"21":1,"22":3,"23":3,"24":1,"25":2,"26":2,"27":2,"28":2},"b":{},"inputSourceMap":{"version":3,"sources":["index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AASA;;AAUA;;AAQA;;AAKA;;AAUA","sourceRoot":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/","sourcesContent":["export {\n    encodeAddress,\n    decodeAddress,\n    encodePrivateKey,\n    decodePrivateKey,\n    encodeTxHash,\n    decodeTxHash,\n} from './encoding';\n\nexport {\n    createIdentity,\n    identityFromPrivateKey as identifyFromPrivateKey, // DEPRECATED (legacy typo)\n    identityFromPrivateKey,\n    addressFromPublicKey,\n    publicKeyFromAddress,\n    decryptPrivateKey,\n    encryptPrivateKey,\n} from './keys';\n\nexport {\n    signMessage,\n    signTransaction,\n    verifySignature,\n    verifyTxSignature,\n    encodeSignature,\n} from './signing';\n\nexport {\n    hash,\n    hashTransaction,\n} from './hashing';\n\nexport {\n    generateMnemonic,\n    mnemonicToSeed,\n    privateKeyFromSeed,\n    privateKeysFromSeed,\n    privateKeyFromMnemonic,\n    privateKeysFromMnemonic,\n    validateMnemonic,\n} from './seed';\n\nexport {\n    identityFromKeystore,\n    keystoreFromPrivateKey,\n} from './keystore';"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fa862b8d6254f56d536bdc1c449d0ef3032eee26","contentHash":"5fcb012d6b32cd1dbcae96fac7d79c6dca10f532c4cc5ee3340a9539521673b4"},"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/encoding.ts":{"path":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/encoding.ts","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":38}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":44}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":36}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":38}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":44}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":36}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":32}},"8":{"start":{"line":13,"column":0},"end":{"line":18,"column":3}},"9":{"start":{"line":16,"column":4},"end":{"line":16,"column":33}},"10":{"start":{"line":19,"column":0},"end":{"line":24,"column":3}},"11":{"start":{"line":22,"column":4},"end":{"line":22,"column":30}},"12":{"start":{"line":26,"column":14},"end":{"line":26,"column":39}},"13":{"start":{"line":28,"column":12},"end":{"line":28,"column":51}},"14":{"start":{"line":30,"column":14},"end":{"line":30,"column":31}},"15":{"start":{"line":32,"column":39},"end":{"line":32,"column":95}},"16":{"start":{"line":34,"column":35},"end":{"line":34,"column":151}},"17":{"start":{"line":36,"column":32},"end":{"line":36,"column":188}},"18":{"start":{"line":38,"column":50},"end":{"line":38,"column":65}},"19":{"start":{"line":38,"column":58},"end":{"line":38,"column":65}},"20":{"start":{"line":38,"column":66},"end":{"line":38,"column":129}},"21":{"start":{"line":38,"column":93},"end":{"line":38,"column":129}},"22":{"start":{"line":38,"column":138},"end":{"line":38,"column":184}},"23":{"start":{"line":38,"column":186},"end":{"line":38,"column":246}},"24":{"start":{"line":38,"column":223},"end":{"line":38,"column":246}},"25":{"start":{"line":38,"column":247},"end":{"line":38,"column":300}},"26":{"start":{"line":38,"column":279},"end":{"line":38,"column":300}},"27":{"start":{"line":38,"column":301},"end":{"line":38,"column":414}},"28":{"start":{"line":38,"column":378},"end":{"line":38,"column":414}},"29":{"start":{"line":40,"column":34},"end":{"line":40,"column":156}},"30":{"start":{"line":40,"column":132},"end":{"line":40,"column":156}},"31":{"start":{"line":42,"column":35},"end":{"line":42,"column":89}},"32":{"start":{"line":42,"column":59},"end":{"line":42,"column":89}},"33":{"start":{"line":44,"column":39},"end":{"line":44,"column":93}},"34":{"start":{"line":44,"column":76},"end":{"line":44,"column":93}},"35":{"start":{"line":44,"column":94},"end":{"line":44,"column":168}},"36":{"start":{"line":44,"column":107},"end":{"line":44,"column":108}},"37":{"start":{"line":44,"column":117},"end":{"line":44,"column":131}},"38":{"start":{"line":44,"column":149},"end":{"line":44,"column":166}},"39":{"start":{"line":44,"column":169},"end":{"line":44,"column":181}},"40":{"start":{"line":51,"column":2},"end":{"line":51,"column":77}},"41":{"start":{"line":61,"column":2},"end":{"line":61,"column":72}},"42":{"start":{"line":71,"column":2},"end":{"line":71,"column":65}},"43":{"start":{"line":81,"column":12},"end":{"line":81,"column":119}},"44":{"start":{"line":83,"column":2},"end":{"line":83,"column":41}},"45":{"start":{"line":93,"column":2},"end":{"line":93,"column":50}},"46":{"start":{"line":103,"column":2},"end":{"line":103,"column":76}},"47":{"start":{"line":113,"column":2},"end":{"line":113,"column":43}}},"fnMap":{"0":{"name":"get","decl":{"start":{"line":15,"column":16},"end":{"line":15,"column":19}},"loc":{"start":{"line":15,"column":22},"end":{"line":17,"column":3}},"line":15},"1":{"name":"get","decl":{"start":{"line":21,"column":16},"end":{"line":21,"column":19}},"loc":{"start":{"line":21,"column":22},"end":{"line":23,"column":3}},"line":21},"2":{"name":"_interopRequireDefault","decl":{"start":{"line":32,"column":9},"end":{"line":32,"column":31}},"loc":{"start":{"line":32,"column":37},"end":{"line":32,"column":97}},"line":32},"3":{"name":"_toConsumableArray","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":27}},"loc":{"start":{"line":34,"column":33},"end":{"line":34,"column":153}},"line":34},"4":{"name":"_nonIterableSpread","decl":{"start":{"line":36,"column":9},"end":{"line":36,"column":27}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":190}},"line":36},"5":{"name":"_unsupportedIterableToArray","decl":{"start":{"line":38,"column":9},"end":{"line":38,"column":36}},"loc":{"start":{"line":38,"column":48},"end":{"line":38,"column":416}},"line":38},"6":{"name":"_iterableToArray","decl":{"start":{"line":40,"column":9},"end":{"line":40,"column":25}},"loc":{"start":{"line":40,"column":32},"end":{"line":40,"column":158}},"line":40},"7":{"name":"_arrayWithoutHoles","decl":{"start":{"line":42,"column":9},"end":{"line":42,"column":27}},"loc":{"start":{"line":42,"column":33},"end":{"line":42,"column":91}},"line":42},"8":{"name":"_arrayLikeToArray","decl":{"start":{"line":44,"column":9},"end":{"line":44,"column":26}},"loc":{"start":{"line":44,"column":37},"end":{"line":44,"column":183}},"line":44},"9":{"name":"fromBigInt","decl":{"start":{"line":50,"column":9},"end":{"line":50,"column":19}},"loc":{"start":{"line":50,"column":23},"end":{"line":52,"column":1}},"line":50},"10":{"name":"encodeAddress","decl":{"start":{"line":60,"column":9},"end":{"line":60,"column":22}},"loc":{"start":{"line":60,"column":34},"end":{"line":62,"column":1}},"line":60},"11":{"name":"decodeAddress","decl":{"start":{"line":70,"column":9},"end":{"line":70,"column":22}},"loc":{"start":{"line":70,"column":32},"end":{"line":72,"column":1}},"line":70},"12":{"name":"encodePrivateKey","decl":{"start":{"line":80,"column":9},"end":{"line":80,"column":25}},"loc":{"start":{"line":80,"column":37},"end":{"line":84,"column":1}},"line":80},"13":{"name":"decodePrivateKey","decl":{"start":{"line":92,"column":9},"end":{"line":92,"column":25}},"loc":{"start":{"line":92,"column":31},"end":{"line":94,"column":1}},"line":92},"14":{"name":"encodeTxHash","decl":{"start":{"line":102,"column":9},"end":{"line":102,"column":21}},"loc":{"start":{"line":102,"column":29},"end":{"line":104,"column":1}},"line":102},"15":{"name":"decodeTxHash","decl":{"start":{"line":112,"column":9},"end":{"line":112,"column":21}},"loc":{"start":{"line":112,"column":34},"end":{"line":114,"column":1}},"line":112}},"branchMap":{"0":{"loc":{"start":{"line":32,"column":46},"end":{"line":32,"column":94}},"type":"cond-expr","locations":[{"start":{"line":32,"column":70},"end":{"line":32,"column":73}},{"start":{"line":32,"column":76},"end":{"line":32,"column":94}}],"line":32},"1":{"loc":{"start":{"line":32,"column":46},"end":{"line":32,"column":67}},"type":"binary-expr","locations":[{"start":{"line":32,"column":46},"end":{"line":32,"column":49}},{"start":{"line":32,"column":53},"end":{"line":32,"column":67}}],"line":32},"2":{"loc":{"start":{"line":34,"column":42},"end":{"line":34,"column":150}},"type":"binary-expr","locations":[{"start":{"line":34,"column":42},"end":{"line":34,"column":65}},{"start":{"line":34,"column":69},"end":{"line":34,"column":90}},{"start":{"line":34,"column":94},"end":{"line":34,"column":126}},{"start":{"line":34,"column":130},"end":{"line":34,"column":150}}],"line":34},"3":{"loc":{"start":{"line":38,"column":50},"end":{"line":38,"column":65}},"type":"if","locations":[{"start":{"line":38,"column":50},"end":{"line":38,"column":65}},{"start":{"line":38,"column":50},"end":{"line":38,"column":65}}],"line":38},"4":{"loc":{"start":{"line":38,"column":66},"end":{"line":38,"column":129}},"type":"if","locations":[{"start":{"line":38,"column":66},"end":{"line":38,"column":129}},{"start":{"line":38,"column":66},"end":{"line":38,"column":129}}],"line":38},"5":{"loc":{"start":{"line":38,"column":186},"end":{"line":38,"column":246}},"type":"if","locations":[{"start":{"line":38,"column":186},"end":{"line":38,"column":246}},{"start":{"line":38,"column":186},"end":{"line":38,"column":246}}],"line":38},"6":{"loc":{"start":{"line":38,"column":190},"end":{"line":38,"column":221}},"type":"binary-expr","locations":[{"start":{"line":38,"column":190},"end":{"line":38,"column":204}},{"start":{"line":38,"column":208},"end":{"line":38,"column":221}}],"line":38},"7":{"loc":{"start":{"line":38,"column":247},"end":{"line":38,"column":300}},"type":"if","locations":[{"start":{"line":38,"column":247},"end":{"line":38,"column":300}},{"start":{"line":38,"column":247},"end":{"line":38,"column":300}}],"line":38},"8":{"loc":{"start":{"line":38,"column":251},"end":{"line":38,"column":277}},"type":"binary-expr","locations":[{"start":{"line":38,"column":251},"end":{"line":38,"column":262}},{"start":{"line":38,"column":266},"end":{"line":38,"column":277}}],"line":38},"9":{"loc":{"start":{"line":38,"column":301},"end":{"line":38,"column":414}},"type":"if","locations":[{"start":{"line":38,"column":301},"end":{"line":38,"column":414}},{"start":{"line":38,"column":301},"end":{"line":38,"column":414}}],"line":38},"10":{"loc":{"start":{"line":38,"column":305},"end":{"line":38,"column":376}},"type":"binary-expr","locations":[{"start":{"line":38,"column":305},"end":{"line":38,"column":322}},{"start":{"line":38,"column":326},"end":{"line":38,"column":376}}],"line":38},"11":{"loc":{"start":{"line":40,"column":34},"end":{"line":40,"column":156}},"type":"if","locations":[{"start":{"line":40,"column":34},"end":{"line":40,"column":156}},{"start":{"line":40,"column":34},"end":{"line":40,"column":156}}],"line":40},"12":{"loc":{"start":{"line":40,"column":38},"end":{"line":40,"column":130}},"type":"binary-expr","locations":[{"start":{"line":40,"column":38},"end":{"line":40,"column":67}},{"start":{"line":40,"column":71},"end":{"line":40,"column":100}},{"start":{"line":40,"column":104},"end":{"line":40,"column":130}}],"line":40},"13":{"loc":{"start":{"line":42,"column":35},"end":{"line":42,"column":89}},"type":"if","locations":[{"start":{"line":42,"column":35},"end":{"line":42,"column":89}},{"start":{"line":42,"column":35},"end":{"line":42,"column":89}}],"line":42},"14":{"loc":{"start":{"line":44,"column":39},"end":{"line":44,"column":93}},"type":"if","locations":[{"start":{"line":44,"column":39},"end":{"line":44,"column":93}},{"start":{"line":44,"column":39},"end":{"line":44,"column":93}}],"line":44},"15":{"loc":{"start":{"line":44,"column":43},"end":{"line":44,"column":74}},"type":"binary-expr","locations":[{"start":{"line":44,"column":43},"end":{"line":44,"column":54}},{"start":{"line":44,"column":58},"end":{"line":44,"column":74}}],"line":44}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":54,"12":1,"13":1,"14":1,"15":1,"16":2,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":2,"30":2,"31":2,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":36,"41":19,"42":26,"43":2,"44":2,"45":3,"46":0,"47":0},"f":{"0":0,"1":54,"2":1,"3":2,"4":0,"5":0,"6":2,"7":2,"8":0,"9":36,"10":19,"11":26,"12":2,"13":3,"14":0,"15":0},"b":{"0":[0,1],"1":[1,1],"2":[2,2,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[2,0],"12":[2,2,0],"13":[0,2],"14":[0,0],"15":[0,0]},"inputSourceMap":{"version":3,"sources":["encoding.ts"],"names":["fromBigInt","d","JSBI","BigInt","toString","encodeAddress","byteArray","Address","Buffer","from","decodeAddress","address","Uint8Array","asBytes","encodePrivateKey","buf","constants","ADDRESS_PREFIXES","PRIVATE_KEY","base58check","encode","decodePrivateKey","key","decode","slice","encodeTxHash","bytes","base58","decodeTxHash","bs58string"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;;;;;;;;;;;;;;;AAKA;AACA;AACA;AACA;AACO,SAASA,UAAT,CAAoBC,CAApB,EAA2D;AAC9D,SAAO,2BAAcC,iBAAKC,MAAL,CAAYF,CAAZ,EAAeG,QAAf,CAAwB,EAAxB,CAAd,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;AACO,SAASC,aAAT,CAAuBC,SAAvB,EAAsD;AACzD,mBAAU,IAAIC,eAAJ,CAAYC,eAAOC,IAAP,CAAYH,SAAZ,CAAZ,CAAV;AACH;AAED;AACA;AACA;AACA;AACA;;;AACO,SAASI,aAAT,CAAuBC,OAAvB,EAAoD;AACvD,SAAOC,UAAU,CAACH,IAAX,CAAgB,IAAIF,eAAJ,CAAYI,OAAZ,EAAqBE,OAArB,EAAhB,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;AACO,SAASC,gBAAT,CAA0BR,SAA1B,EAAyD;AAC5D,MAAMS,GAAG,GAAGP,eAAOC,IAAP,EAAaO,kBAAUC,gBAAV,CAA2BC,WAAxC,4BAAwDZ,SAAxD,GAAZ;;AACA,SAAOa,oBAAYC,MAAZ,CAAmBL,GAAnB,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;AACO,SAASM,gBAAT,CAA0BC,GAA1B,EAAmD;AACtD,SAAOH,oBAAYI,MAAZ,CAAmBD,GAAnB,EAAwBE,KAAxB,CAA8B,CAA9B,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;AACO,SAASC,YAAT,CAAsBC,KAAtB,EAA4D;AAC/D,SAAOC,eAAOP,MAAP,CAAcZ,eAAOC,IAAP,CAAYG,UAAU,CAACH,IAAX,CAAgBiB,KAAhB,CAAZ,CAAd,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;AACO,SAASE,YAAT,CAAsBC,UAAtB,EAAsD;AACzD,SAAOF,eAAOJ,MAAP,CAAcM,UAAd,CAAP;AACH","sourceRoot":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/","sourcesContent":["import { constants, Address, fromHexString, fromNumber, base58, base58check } from '@herajs/common';\nimport JSBI from 'jsbi';\nimport { Buffer } from 'buffer';\n\nexport { fromHexString };\nexport { fromNumber };\n\n/**\n * Converts BigInt to Uint8 array.\n * @param {JSBI} d\n */\nexport function fromBigInt(d: JSBI | string | number): Uint8Array {\n    return fromHexString(JSBI.BigInt(d).toString(16));\n}\n\n/**\n * Encodes address or name from byte array to string.\n * @param {number[]} byteArray\n * @returns {string} base58check encoded address or name\n */\nexport function encodeAddress(byteArray: Uint8Array): string {\n    return `${new Address(Buffer.from(byteArray))}`;\n}\n\n/**\n * Decodes address from string to byte array.\n * @param {string} address base58check encoded address or name\n * @return {number[]} byte array\n */\nexport function decodeAddress(address: string): Uint8Array {\n    return Uint8Array.from(new Address(address).asBytes());\n}\n\n/**\n * Encodes address form byte array to string.\n * @param {number[]} byteArray \n * @param {string} address\n */\nexport function encodePrivateKey(byteArray: Uint8Array): string {\n    const buf = Buffer.from([constants.ADDRESS_PREFIXES.PRIVATE_KEY, ...byteArray]);\n    return base58check.encode(buf);\n}\n\n/**\n * Decodes address from string to byte array.\n * @param {string} address base58check encoded privkey \n * @return {number[]} byte array\n */\nexport function decodePrivateKey(key: string): Uint8Array {\n    return base58check.decode(key).slice(1);\n}\n\n/**\n * Encodes data as base58 encoded string.\n * @param {Uint8Array} bytes data\n * @return {string} base58 encoded string\n */\nexport function encodeTxHash(bytes: Uint8Array | number[]): string {\n    return base58.encode(Buffer.from(Uint8Array.from(bytes)));\n}\n\n/**\n * Decodes base58 encoded data.\n * @param {string} bs58string base58 encoded string\n * @return {Uint8Array} decoded data\n */\nexport function decodeTxHash(bs58string: string): Uint8Array {\n    return base58.decode(bs58string);\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"580f37524e565c3b4ec19cf7b49846a8b452baa2","contentHash":"9c05910d48e689c118b1f89363323d3580b49b583ca51b8fe268df8d237f7e6d"},"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/keys.ts":{"path":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/keys.ts","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":52}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":40}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":46}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":40}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":46}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":56}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":52}},"8":{"start":{"line":14,"column":17},"end":{"line":14,"column":40}},"9":{"start":{"line":16,"column":16},"end":{"line":16,"column":37}},"10":{"start":{"line":18,"column":14},"end":{"line":18,"column":31}},"11":{"start":{"line":20,"column":13},"end":{"line":20,"column":31}},"12":{"start":{"line":22,"column":34},"end":{"line":22,"column":156}},"13":{"start":{"line":24,"column":30},"end":{"line":24,"column":191}},"14":{"start":{"line":26,"column":50},"end":{"line":26,"column":65}},"15":{"start":{"line":26,"column":58},"end":{"line":26,"column":65}},"16":{"start":{"line":26,"column":66},"end":{"line":26,"column":129}},"17":{"start":{"line":26,"column":93},"end":{"line":26,"column":129}},"18":{"start":{"line":26,"column":138},"end":{"line":26,"column":184}},"19":{"start":{"line":26,"column":186},"end":{"line":26,"column":246}},"20":{"start":{"line":26,"column":223},"end":{"line":26,"column":246}},"21":{"start":{"line":26,"column":247},"end":{"line":26,"column":300}},"22":{"start":{"line":26,"column":279},"end":{"line":26,"column":300}},"23":{"start":{"line":26,"column":301},"end":{"line":26,"column":414}},"24":{"start":{"line":26,"column":378},"end":{"line":26,"column":414}},"25":{"start":{"line":28,"column":39},"end":{"line":28,"column":93}},"26":{"start":{"line":28,"column":76},"end":{"line":28,"column":93}},"27":{"start":{"line":28,"column":94},"end":{"line":28,"column":168}},"28":{"start":{"line":28,"column":107},"end":{"line":28,"column":108}},"29":{"start":{"line":28,"column":117},"end":{"line":28,"column":131}},"30":{"start":{"line":28,"column":149},"end":{"line":28,"column":166}},"31":{"start":{"line":28,"column":169},"end":{"line":28,"column":181}},"32":{"start":{"line":30,"column":50},"end":{"line":30,"column":145}},"33":{"start":{"line":30,"column":147},"end":{"line":30,"column":170}},"34":{"start":{"line":30,"column":163},"end":{"line":30,"column":170}},"35":{"start":{"line":30,"column":182},"end":{"line":30,"column":184}},"36":{"start":{"line":30,"column":195},"end":{"line":30,"column":199}},"37":{"start":{"line":30,"column":210},"end":{"line":30,"column":215}},"38":{"start":{"line":30,"column":229},"end":{"line":30,"column":498}},"39":{"start":{"line":30,"column":235},"end":{"line":30,"column":360}},"40":{"start":{"line":30,"column":303},"end":{"line":30,"column":323}},"41":{"start":{"line":30,"column":324},"end":{"line":30,"column":358}},"42":{"start":{"line":30,"column":352},"end":{"line":30,"column":358}},"43":{"start":{"line":30,"column":377},"end":{"line":30,"column":387}},"44":{"start":{"line":30,"column":388},"end":{"line":30,"column":397}},"45":{"start":{"line":30,"column":410},"end":{"line":30,"column":496}},"46":{"start":{"line":30,"column":416},"end":{"line":30,"column":464}},"47":{"start":{"line":30,"column":449},"end":{"line":30,"column":464}},"48":{"start":{"line":30,"column":477},"end":{"line":30,"column":494}},"49":{"start":{"line":30,"column":485},"end":{"line":30,"column":494}},"50":{"start":{"line":30,"column":499},"end":{"line":30,"column":511}},"51":{"start":{"line":32,"column":32},"end":{"line":32,"column":67}},"52":{"start":{"line":32,"column":56},"end":{"line":32,"column":67}},"53":{"start":{"line":35,"column":2},"end":{"line":35,"column":60}},"54":{"start":{"line":45,"column":12},"end":{"line":45,"column":42}},"55":{"start":{"line":46,"column":10},"end":{"line":46,"column":45}},"56":{"start":{"line":47,"column":16},"end":{"line":47,"column":84}},"57":{"start":{"line":48,"column":2},"end":{"line":48,"column":47}},"58":{"start":{"line":58,"column":2},"end":{"line":60,"column":3}},"59":{"start":{"line":59,"column":4},"end":{"line":59,"column":53}},"60":{"start":{"line":62,"column":15},"end":{"line":62,"column":63}},"61":{"start":{"line":63,"column":2},"end":{"line":63,"column":44}},"62":{"start":{"line":74,"column":19},"end":{"line":74,"column":70}},"63":{"start":{"line":76,"column":18},"end":{"line":76,"column":37}},"64":{"start":{"line":77,"column":16},"end":{"line":77,"column":47}},"65":{"start":{"line":78,"column":2},"end":{"line":83,"column":4}},"66":{"start":{"line":93,"column":16},"end":{"line":93,"column":41}},"67":{"start":{"line":95,"column":2},"end":{"line":95,"column":33}},"68":{"start":{"line":105,"column":16},"end":{"line":105,"column":78}},"69":{"start":{"line":107,"column":2},"end":{"line":107,"column":33}},"70":{"start":{"line":110,"column":31},"end":{"line":127,"column":1}},"71":{"start":{"line":112,"column":13},"end":{"line":112,"column":32}},"72":{"start":{"line":114,"column":2},"end":{"line":114,"column":24}},"73":{"start":{"line":115,"column":13},"end":{"line":115,"column":26}},"74":{"start":{"line":117,"column":15},"end":{"line":117,"column":34}},"75":{"start":{"line":119,"column":2},"end":{"line":119,"column":26}},"76":{"start":{"line":120,"column":2},"end":{"line":120,"column":22}},"77":{"start":{"line":122,"column":12},"end":{"line":122,"column":48}},"78":{"start":{"line":124,"column":14},"end":{"line":124,"column":52}},"79":{"start":{"line":126,"column":2},"end":{"line":126,"column":22}},"80":{"start":{"line":135,"column":30},"end":{"line":135,"column":64}},"81":{"start":{"line":136,"column":31},"end":{"line":136,"column":71}},"82":{"start":{"line":137,"column":12},"end":{"line":137,"column":37}},"83":{"start":{"line":138,"column":14},"end":{"line":138,"column":39}},"84":{"start":{"line":140,"column":2},"end":{"line":140,"column":81}},"85":{"start":{"line":149,"column":31},"end":{"line":149,"column":65}},"86":{"start":{"line":150,"column":31},"end":{"line":150,"column":72}},"87":{"start":{"line":151,"column":12},"end":{"line":151,"column":37}},"88":{"start":{"line":152,"column":14},"end":{"line":152,"column":39}},"89":{"start":{"line":154,"column":2},"end":{"line":154,"column":77}}},"fnMap":{"0":{"name":"_slicedToArray","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":23}},"loc":{"start":{"line":22,"column":32},"end":{"line":22,"column":158}},"line":22},"1":{"name":"_nonIterableRest","decl":{"start":{"line":24,"column":9},"end":{"line":24,"column":25}},"loc":{"start":{"line":24,"column":28},"end":{"line":24,"column":193}},"line":24},"2":{"name":"_unsupportedIterableToArray","decl":{"start":{"line":26,"column":9},"end":{"line":26,"column":36}},"loc":{"start":{"line":26,"column":48},"end":{"line":26,"column":416}},"line":26},"3":{"name":"_arrayLikeToArray","decl":{"start":{"line":28,"column":9},"end":{"line":28,"column":26}},"loc":{"start":{"line":28,"column":37},"end":{"line":28,"column":183}},"line":28},"4":{"name":"_iterableToArrayLimit","decl":{"start":{"line":30,"column":9},"end":{"line":30,"column":30}},"loc":{"start":{"line":30,"column":39},"end":{"line":30,"column":513}},"line":30},"5":{"name":"_arrayWithHoles","decl":{"start":{"line":32,"column":9},"end":{"line":32,"column":24}},"loc":{"start":{"line":32,"column":30},"end":{"line":32,"column":69}},"line":32},"6":{"name":"isBytesConvertible","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":27}},"loc":{"start":{"line":34,"column":33},"end":{"line":36,"column":1}},"line":34},"7":{"name":"addressFromPublicKey","decl":{"start":{"line":44,"column":9},"end":{"line":44,"column":29}},"loc":{"start":{"line":44,"column":41},"end":{"line":49,"column":1}},"line":44},"8":{"name":"publicKeyFromAddress","decl":{"start":{"line":57,"column":9},"end":{"line":57,"column":29}},"loc":{"start":{"line":57,"column":39},"end":{"line":64,"column":1}},"line":57},"9":{"name":"encodeIdentity","decl":{"start":{"line":72,"column":9},"end":{"line":72,"column":23}},"loc":{"start":{"line":72,"column":33},"end":{"line":84,"column":1}},"line":72},"10":{"name":"createIdentity","decl":{"start":{"line":92,"column":9},"end":{"line":92,"column":23}},"loc":{"start":{"line":92,"column":26},"end":{"line":96,"column":1}},"line":92},"11":{"name":"identityFromPrivateKey","decl":{"start":{"line":104,"column":9},"end":{"line":104,"column":31}},"loc":{"start":{"line":104,"column":46},"end":{"line":108,"column":1}},"line":104},"12":{"name":"_keyAndNonceFromPassword","decl":{"start":{"line":110,"column":40},"end":{"line":110,"column":64}},"loc":{"start":{"line":110,"column":75},"end":{"line":127,"column":1}},"line":110},"13":{"name":"decryptPrivateKey","decl":{"start":{"line":134,"column":9},"end":{"line":134,"column":26}},"loc":{"start":{"line":134,"column":53},"end":{"line":141,"column":1}},"line":134},"14":{"name":"encryptPrivateKey","decl":{"start":{"line":148,"column":9},"end":{"line":148,"column":26}},"loc":{"start":{"line":148,"column":49},"end":{"line":155,"column":1}},"line":148}},"branchMap":{"0":{"loc":{"start":{"line":22,"column":41},"end":{"line":22,"column":155}},"type":"binary-expr","locations":[{"start":{"line":22,"column":41},"end":{"line":22,"column":61}},{"start":{"line":22,"column":65},"end":{"line":22,"column":94}},{"start":{"line":22,"column":98},"end":{"line":22,"column":133}},{"start":{"line":22,"column":137},"end":{"line":22,"column":155}}],"line":22},"1":{"loc":{"start":{"line":26,"column":50},"end":{"line":26,"column":65}},"type":"if","locations":[{"start":{"line":26,"column":50},"end":{"line":26,"column":65}},{"start":{"line":26,"column":50},"end":{"line":26,"column":65}}],"line":26},"2":{"loc":{"start":{"line":26,"column":66},"end":{"line":26,"column":129}},"type":"if","locations":[{"start":{"line":26,"column":66},"end":{"line":26,"column":129}},{"start":{"line":26,"column":66},"end":{"line":26,"column":129}}],"line":26},"3":{"loc":{"start":{"line":26,"column":186},"end":{"line":26,"column":246}},"type":"if","locations":[{"start":{"line":26,"column":186},"end":{"line":26,"column":246}},{"start":{"line":26,"column":186},"end":{"line":26,"column":246}}],"line":26},"4":{"loc":{"start":{"line":26,"column":190},"end":{"line":26,"column":221}},"type":"binary-expr","locations":[{"start":{"line":26,"column":190},"end":{"line":26,"column":204}},{"start":{"line":26,"column":208},"end":{"line":26,"column":221}}],"line":26},"5":{"loc":{"start":{"line":26,"column":247},"end":{"line":26,"column":300}},"type":"if","locations":[{"start":{"line":26,"column":247},"end":{"line":26,"column":300}},{"start":{"line":26,"column":247},"end":{"line":26,"column":300}}],"line":26},"6":{"loc":{"start":{"line":26,"column":251},"end":{"line":26,"column":277}},"type":"binary-expr","locations":[{"start":{"line":26,"column":251},"end":{"line":26,"column":262}},{"start":{"line":26,"column":266},"end":{"line":26,"column":277}}],"line":26},"7":{"loc":{"start":{"line":26,"column":301},"end":{"line":26,"column":414}},"type":"if","locations":[{"start":{"line":26,"column":301},"end":{"line":26,"column":414}},{"start":{"line":26,"column":301},"end":{"line":26,"column":414}}],"line":26},"8":{"loc":{"start":{"line":26,"column":305},"end":{"line":26,"column":376}},"type":"binary-expr","locations":[{"start":{"line":26,"column":305},"end":{"line":26,"column":322}},{"start":{"line":26,"column":326},"end":{"line":26,"column":376}}],"line":26},"9":{"loc":{"start":{"line":28,"column":39},"end":{"line":28,"column":93}},"type":"if","locations":[{"start":{"line":28,"column":39},"end":{"line":28,"column":93}},{"start":{"line":28,"column":39},"end":{"line":28,"column":93}}],"line":28},"10":{"loc":{"start":{"line":28,"column":43},"end":{"line":28,"column":74}},"type":"binary-expr","locations":[{"start":{"line":28,"column":43},"end":{"line":28,"column":54}},{"start":{"line":28,"column":58},"end":{"line":28,"column":74}}],"line":28},"11":{"loc":{"start":{"line":30,"column":50},"end":{"line":30,"column":145}},"type":"cond-expr","locations":[{"start":{"line":30,"column":64},"end":{"line":30,"column":68}},{"start":{"line":30,"column":71},"end":{"line":30,"column":145}}],"line":30},"12":{"loc":{"start":{"line":30,"column":71},"end":{"line":30,"column":145}},"type":"binary-expr","locations":[{"start":{"line":30,"column":71},"end":{"line":30,"column":100}},{"start":{"line":30,"column":104},"end":{"line":30,"column":124}},{"start":{"line":30,"column":128},"end":{"line":30,"column":145}}],"line":30},"13":{"loc":{"start":{"line":30,"column":147},"end":{"line":30,"column":170}},"type":"if","locations":[{"start":{"line":30,"column":147},"end":{"line":30,"column":170}},{"start":{"line":30,"column":147},"end":{"line":30,"column":170}}],"line":30},"14":{"loc":{"start":{"line":30,"column":324},"end":{"line":30,"column":358}},"type":"if","locations":[{"start":{"line":30,"column":324},"end":{"line":30,"column":358}},{"start":{"line":30,"column":324},"end":{"line":30,"column":358}}],"line":30},"15":{"loc":{"start":{"line":30,"column":328},"end":{"line":30,"column":350}},"type":"binary-expr","locations":[{"start":{"line":30,"column":328},"end":{"line":30,"column":329}},{"start":{"line":30,"column":333},"end":{"line":30,"column":350}}],"line":30},"16":{"loc":{"start":{"line":30,"column":416},"end":{"line":30,"column":464}},"type":"if","locations":[{"start":{"line":30,"column":416},"end":{"line":30,"column":464}},{"start":{"line":30,"column":416},"end":{"line":30,"column":464}}],"line":30},"17":{"loc":{"start":{"line":30,"column":420},"end":{"line":30,"column":447}},"type":"binary-expr","locations":[{"start":{"line":30,"column":420},"end":{"line":30,"column":423}},{"start":{"line":30,"column":427},"end":{"line":30,"column":447}}],"line":30},"18":{"loc":{"start":{"line":30,"column":477},"end":{"line":30,"column":494}},"type":"if","locations":[{"start":{"line":30,"column":477},"end":{"line":30,"column":494}},{"start":{"line":30,"column":477},"end":{"line":30,"column":494}}],"line":30},"19":{"loc":{"start":{"line":32,"column":32},"end":{"line":32,"column":67}},"type":"if","locations":[{"start":{"line":32,"column":32},"end":{"line":32,"column":67}},{"start":{"line":32,"column":32},"end":{"line":32,"column":67}}],"line":32},"20":{"loc":{"start":{"line":47,"column":33},"end":{"line":47,"column":72}},"type":"cond-expr","locations":[{"start":{"line":47,"column":61},"end":{"line":47,"column":65}},{"start":{"line":47,"column":68},"end":{"line":47,"column":72}}],"line":47},"21":{"loc":{"start":{"line":58,"column":2},"end":{"line":60,"column":3}},"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":60,"column":3}},{"start":{"line":58,"column":2},"end":{"line":60,"column":3}}],"line":58}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":5,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":5,"52":5,"53":3,"54":17,"55":17,"56":17,"57":17,"58":3,"59":0,"60":3,"61":3,"62":17,"63":17,"64":17,"65":17,"66":5,"67":5,"68":12,"69":12,"70":1,"71":5,"72":5,"73":5,"74":5,"75":5,"76":5,"77":5,"78":5,"79":5,"80":3,"81":3,"82":3,"83":3,"84":3,"85":2,"86":2,"87":2,"88":2,"89":2},"f":{"0":5,"1":0,"2":0,"3":0,"4":0,"5":5,"6":3,"7":17,"8":3,"9":17,"10":5,"11":12,"12":5,"13":3,"14":2},"b":{"0":[5,0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[5,0],"20":[11,6],"21":[0,3]},"inputSourceMap":{"version":3,"sources":["keys.ts"],"names":["isBytesConvertible","obj","Object","prototype","hasOwnProperty","call","addressFromPublicKey","publicKey","len","curve","p","byteLength","x","getX","toArray","address","Uint8Array","from","getY","isEven","concat","publicKeyFromAddress","ecdsa","keyFromPublic","bytes","pubkey","encodeIdentity","keyPair","privateKey","Buffer","getPrivate","getPublic","createIdentity","genKeyPair","identityFromPrivateKey","privKeyBytes","keyFromPrivate","_keyAndNonceFromPassword","password","hash","update","addr","digest","rehash","key","nonce","slice","decryptPrivateKey","encryptedBytes","AES_GCM","decrypt","encryptPrivateKey","clearBytes","encrypt"],"mappings":"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","sourceRoot":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/","sourcesContent":["import { AES_GCM } from 'asmcrypto.js';\nimport { encodeAddress, decodeAddress } from './encoding';\nimport { Buffer } from 'buffer';\nimport { ec } from 'elliptic';\nimport { ecdsa } from './ecdsa';\n\nexport interface Identity {\n    address: string;\n    publicKey: any; //?\n    privateKey: Buffer;\n    keyPair: ec.KeyPair;\n}\n\ninterface StringCovertible {\n    toString(): string;\n}\n\n/**\n * An object that's convertible to bytes, e.g. client.Address.\n * Used in this indirect way so we don't have to import @herajs/client here.\n */\ninterface BytesConvertible {\n    bytes: Uint8Array;\n}\nfunction isBytesConvertible(obj: any): obj is BytesConvertible {\n    return Object.prototype.hasOwnProperty.call(obj, 'bytes');\n}\n\n/**\n * Encode public key as address\n * @param {ECPoint} publicKey\n * @return {string} base58check encoded address\n */\nexport function addressFromPublicKey(publicKey: any): string {\n    const len = publicKey.curve.p.byteLength();\n    const x = publicKey.getX().toArray('be', len);\n    const address = Uint8Array.from([ publicKey.getY().isEven() ? 0x02 : 0x03 ].concat(x));\n    return encodeAddress(address);\n}\n\n/**\n * Retrieve public key from address\n * @param {string} base58check encoded address or Address object\n * @return {KeyPair} key pair (with missing private key)\n */\nexport function publicKeyFromAddress(address: string | BytesConvertible | StringCovertible): ec.KeyPair {\n    if (isBytesConvertible(address)) {\n        return ecdsa.keyFromPublic(address.bytes);\n    }\n    const pubkey = decodeAddress(`${address}`) as Buffer;\n    return ecdsa.keyFromPublic(pubkey);\n}\n\n/**\n * Encodes a key pair into an identity object\n * @param {KeyPair} keyPair \n * @return {Identity} identity including address and keys\n */\nexport function encodeIdentity(keyPair: ec.KeyPair): Identity {\n    //@ts-ignore\n    const privateKey = Buffer.from(keyPair.getPrivate().toArray()) as Buffer;\n    const publicKey = keyPair.getPublic();\n    const address = addressFromPublicKey(publicKey);\n    return {\n        address,\n        publicKey,\n        privateKey,\n        keyPair\n    };\n}\n\n/**\n * Shortcut function to create a new random private key and\n * return keys and address as encoded strings.\n * @return {Identity} identity including address and keys\n */\nexport function createIdentity(): Identity {\n    const keyPair = ecdsa.genKeyPair();\n    return encodeIdentity(keyPair);\n}\n\n/**\n * Returns identity associated with private key\n * @param {Uint8Array} privKeyBytes \n * @returns {Identity} identity including address and keys \n */\nexport function identityFromPrivateKey(privKeyBytes: Uint8Array): Identity {\n    const keyPair = ecdsa.keyFromPrivate(Buffer.from(privKeyBytes));\n    return encodeIdentity(keyPair);\n}\n\nconst _keyAndNonceFromPassword = (password: string): [Buffer, Buffer] => {\n    // Make a key from double hashing the password\n    const hash = ecdsa.hash();\n    hash.update(password);\n    const addr = hash.digest();\n    const rehash = ecdsa.hash();\n    rehash.update(password);\n    rehash.update(addr);\n    const key = Buffer.from(rehash.digest());\n    const nonce = Buffer.from(addr.slice(4, 16));\n    return [key, nonce];\n};\n\n/**\n * Decrypt an AES_GCM encrypted private key\n * @returns {Uint8Array} decrypted private key bytes\n */\nexport function decryptPrivateKey(encryptedBytes: Uint8Array, password: string): Uint8Array {\n    const [key, nonce] = _keyAndNonceFromPassword(password);\n    return AES_GCM.decrypt(Uint8Array.from(encryptedBytes), key, nonce);\n}\n\n/**\n * Encrypt a private key using AES_GCM\n * @returns {Uint8Array} encrypted private key bytes\n */\nexport function encryptPrivateKey(clearBytes: Uint8Array, password: string): Uint8Array {\n    const [key, nonce] = _keyAndNonceFromPassword(password);\n    return AES_GCM.encrypt(Uint8Array.from(clearBytes), key, nonce);\n}\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c4b1cf721c82800c625a65c25db447b068b05554","contentHash":"977f2a28d64eb94be3df77e913ee12898aec0c81a4118529e77250bffa460be0"},"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/ecdsa.ts":{"path":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/ecdsa.ts","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":23}},"2":{"start":{"line":8,"column":16},"end":{"line":8,"column":35}},"3":{"start":{"line":10,"column":12},"end":{"line":10,"column":41}},"4":{"start":{"line":11,"column":0},"end":{"line":11,"column":22}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["ecdsa.ts"],"names":["ecdsa","ec"],"mappings":";;;;;;;AAAA;;AACA,IAAMA,KAAK,GAAG,IAAIC,YAAJ,CAAO,WAAP,CAAd","sourceRoot":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/","sourcesContent":["import { ec } from 'elliptic';\nconst ecdsa = new ec('secp256k1');\nexport { ecdsa };"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"87e2735e0ae3d1d39d975b79aa4120c5c3ebfd7e","contentHash":"acd434c61765303b4115c511748d4c014fbcc083d7f29bfe8104ebd0b8d96dc7"},"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/signing.ts":{"path":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/signing.ts","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":42}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":34}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":42}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":42}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":46}},"6":{"start":{"line":12,"column":15},"end":{"line":12,"column":35}},"7":{"start":{"line":14,"column":14},"end":{"line":14,"column":31}},"8":{"start":{"line":16,"column":14},"end":{"line":16,"column":39}},"9":{"start":{"line":18,"column":77},"end":{"line":18,"column":175}},"10":{"start":{"line":18,"column":94},"end":{"line":18,"column":107}},"11":{"start":{"line":18,"column":121},"end":{"line":18,"column":131}},"12":{"start":{"line":18,"column":151},"end":{"line":18,"column":165}},"13":{"start":{"line":18,"column":166},"end":{"line":18,"column":173}},"14":{"start":{"line":18,"column":176},"end":{"line":18,"column":263}},"15":{"start":{"line":18,"column":193},"end":{"line":18,"column":208}},"16":{"start":{"line":18,"column":218},"end":{"line":18,"column":261}},"17":{"start":{"line":20,"column":33},"end":{"line":20,"column":387}},"18":{"start":{"line":20,"column":65},"end":{"line":20,"column":69}},"19":{"start":{"line":20,"column":78},"end":{"line":20,"column":87}},"20":{"start":{"line":20,"column":89},"end":{"line":20,"column":384}},"21":{"start":{"line":20,"column":147},"end":{"line":20,"column":167}},"22":{"start":{"line":20,"column":193},"end":{"line":20,"column":264}},"23":{"start":{"line":20,"column":290},"end":{"line":20,"column":360}},"24":{"start":{"line":20,"column":363},"end":{"line":20,"column":380}},"25":{"start":{"line":27,"column":12},"end":{"line":27,"column":88}},"26":{"start":{"line":28,"column":2},"end":{"line":28,"column":74}},"27":{"start":{"line":39,"column":2},"end":{"line":39,"column":45}},"28":{"start":{"line":49,"column":2},"end":{"line":53,"column":5}},"29":{"start":{"line":50,"column":14},"end":{"line":50,"column":90}},"30":{"start":{"line":51,"column":14},"end":{"line":51,"column":31}},"31":{"start":{"line":52,"column":4},"end":{"line":52,"column":37}},"32":{"start":{"line":54,"column":2},"end":{"line":54,"column":45}},"33":{"start":{"line":58,"column":2},"end":{"line":58,"column":49}},"34":{"start":{"line":67,"column":2},"end":{"line":71,"column":5}},"35":{"start":{"line":68,"column":14},"end":{"line":68,"column":90}},"36":{"start":{"line":69,"column":18},"end":{"line":69,"column":73}},"37":{"start":{"line":70,"column":4},"end":{"line":70,"column":42}},"38":{"start":{"line":72,"column":2},"end":{"line":72,"column":49}},"39":{"start":{"line":76,"column":2},"end":{"line":76,"column":49}},"40":{"start":{"line":84,"column":2},"end":{"line":94,"column":5}},"41":{"start":{"line":85,"column":14},"end":{"line":85,"column":90}},"42":{"start":{"line":87,"column":4},"end":{"line":93,"column":5}},"43":{"start":{"line":88,"column":17},"end":{"line":88,"column":59}},"44":{"start":{"line":90,"column":6},"end":{"line":90,"column":35}},"45":{"start":{"line":92,"column":6},"end":{"line":92,"column":54}},"46":{"start":{"line":95,"column":2},"end":{"line":95,"column":49}},"47":{"start":{"line":99,"column":2},"end":{"line":99,"column":51}},"48":{"start":{"line":103,"column":2},"end":{"line":107,"column":5}},"49":{"start":{"line":104,"column":14},"end":{"line":104,"column":90}},"50":{"start":{"line":105,"column":14},"end":{"line":105,"column":69}},"51":{"start":{"line":106,"column":4},"end":{"line":106,"column":59}},"52":{"start":{"line":108,"column":2},"end":{"line":108,"column":51}}},"fnMap":{"0":{"name":"asyncGeneratorStep","decl":{"start":{"line":18,"column":9},"end":{"line":18,"column":27}},"loc":{"start":{"line":18,"column":75},"end":{"line":18,"column":265}},"line":18},"1":{"name":"_asyncToGenerator","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":26}},"loc":{"start":{"line":20,"column":31},"end":{"line":20,"column":389}},"line":20},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":40},"end":{"line":20,"column":41}},"loc":{"start":{"line":20,"column":52},"end":{"line":20,"column":386}},"line":20},"3":{"name":"(anonymous_3)","decl":{"start":{"line":20,"column":108},"end":{"line":20,"column":109}},"loc":{"start":{"line":20,"column":135},"end":{"line":20,"column":382}},"line":20},"4":{"name":"_next","decl":{"start":{"line":20,"column":178},"end":{"line":20,"column":183}},"loc":{"start":{"line":20,"column":191},"end":{"line":20,"column":266}},"line":20},"5":{"name":"_throw","decl":{"start":{"line":20,"column":276},"end":{"line":20,"column":282}},"loc":{"start":{"line":20,"column":288},"end":{"line":20,"column":362}},"line":20},"6":{"name":"encodeSignature","decl":{"start":{"line":26,"column":9},"end":{"line":26,"column":24}},"loc":{"start":{"line":26,"column":30},"end":{"line":29,"column":1}},"line":26},"7":{"name":"signMessage","decl":{"start":{"line":38,"column":9},"end":{"line":38,"column":20}},"loc":{"start":{"line":38,"column":30},"end":{"line":40,"column":1}},"line":38},"8":{"name":"_signMessage","decl":{"start":{"line":48,"column":9},"end":{"line":48,"column":21}},"loc":{"start":{"line":48,"column":24},"end":{"line":55,"column":1}},"line":48},"9":{"name":"(anonymous_9)","decl":{"start":{"line":49,"column":35},"end":{"line":49,"column":36}},"loc":{"start":{"line":49,"column":60},"end":{"line":53,"column":3}},"line":49},"10":{"name":"signTransaction","decl":{"start":{"line":57,"column":9},"end":{"line":57,"column":24}},"loc":{"start":{"line":57,"column":35},"end":{"line":59,"column":1}},"line":57},"11":{"name":"_signTransaction","decl":{"start":{"line":66,"column":9},"end":{"line":66,"column":25}},"loc":{"start":{"line":66,"column":28},"end":{"line":73,"column":1}},"line":66},"12":{"name":"(anonymous_12)","decl":{"start":{"line":67,"column":39},"end":{"line":67,"column":40}},"loc":{"start":{"line":67,"column":59},"end":{"line":71,"column":3}},"line":67},"13":{"name":"verifySignature","decl":{"start":{"line":75,"column":9},"end":{"line":75,"column":24}},"loc":{"start":{"line":75,"column":40},"end":{"line":77,"column":1}},"line":75},"14":{"name":"_verifySignature","decl":{"start":{"line":83,"column":9},"end":{"line":83,"column":25}},"loc":{"start":{"line":83,"column":28},"end":{"line":96,"column":1}},"line":83},"15":{"name":"(anonymous_15)","decl":{"start":{"line":84,"column":39},"end":{"line":84,"column":40}},"loc":{"start":{"line":84,"column":71},"end":{"line":94,"column":3}},"line":84},"16":{"name":"verifyTxSignature","decl":{"start":{"line":98,"column":9},"end":{"line":98,"column":26}},"loc":{"start":{"line":98,"column":43},"end":{"line":100,"column":1}},"line":98},"17":{"name":"_verifyTxSignature","decl":{"start":{"line":102,"column":9},"end":{"line":102,"column":27}},"loc":{"start":{"line":102,"column":30},"end":{"line":109,"column":1}},"line":102},"18":{"name":"(anonymous_18)","decl":{"start":{"line":103,"column":41},"end":{"line":103,"column":42}},"loc":{"start":{"line":103,"column":72},"end":{"line":107,"column":3}},"line":103}},"branchMap":{"0":{"loc":{"start":{"line":18,"column":176},"end":{"line":18,"column":263}},"type":"if","locations":[{"start":{"line":18,"column":176},"end":{"line":18,"column":263}},{"start":{"line":18,"column":176},"end":{"line":18,"column":263}}],"line":18},"1":{"loc":{"start":{"line":27,"column":12},"end":{"line":27,"column":88}},"type":"cond-expr","locations":[{"start":{"line":27,"column":65},"end":{"line":27,"column":77}},{"start":{"line":27,"column":80},"end":{"line":27,"column":88}}],"line":27},"2":{"loc":{"start":{"line":27,"column":12},"end":{"line":27,"column":62}},"type":"binary-expr","locations":[{"start":{"line":27,"column":12},"end":{"line":27,"column":32}},{"start":{"line":27,"column":36},"end":{"line":27,"column":62}}],"line":27},"3":{"loc":{"start":{"line":50,"column":14},"end":{"line":50,"column":90}},"type":"cond-expr","locations":[{"start":{"line":50,"column":67},"end":{"line":50,"column":79}},{"start":{"line":50,"column":82},"end":{"line":50,"column":90}}],"line":50},"4":{"loc":{"start":{"line":50,"column":14},"end":{"line":50,"column":64}},"type":"binary-expr","locations":[{"start":{"line":50,"column":14},"end":{"line":50,"column":34}},{"start":{"line":50,"column":38},"end":{"line":50,"column":64}}],"line":50},"5":{"loc":{"start":{"line":68,"column":14},"end":{"line":68,"column":90}},"type":"cond-expr","locations":[{"start":{"line":68,"column":67},"end":{"line":68,"column":79}},{"start":{"line":68,"column":82},"end":{"line":68,"column":90}}],"line":68},"6":{"loc":{"start":{"line":68,"column":14},"end":{"line":68,"column":64}},"type":"binary-expr","locations":[{"start":{"line":68,"column":14},"end":{"line":68,"column":34}},{"start":{"line":68,"column":38},"end":{"line":68,"column":64}}],"line":68},"7":{"loc":{"start":{"line":85,"column":14},"end":{"line":85,"column":90}},"type":"cond-expr","locations":[{"start":{"line":85,"column":67},"end":{"line":85,"column":79}},{"start":{"line":85,"column":82},"end":{"line":85,"column":90}}],"line":85},"8":{"loc":{"start":{"line":85,"column":14},"end":{"line":85,"column":64}},"type":"binary-expr","locations":[{"start":{"line":85,"column":14},"end":{"line":85,"column":34}},{"start":{"line":85,"column":38},"end":{"line":85,"column":64}}],"line":85},"9":{"loc":{"start":{"line":104,"column":14},"end":{"line":104,"column":90}},"type":"cond-expr","locations":[{"start":{"line":104,"column":67},"end":{"line":104,"column":79}},{"start":{"line":104,"column":82},"end":{"line":104,"column":90}}],"line":104},"10":{"loc":{"start":{"line":104,"column":14},"end":{"line":104,"column":64}},"type":"binary-expr","locations":[{"start":{"line":104,"column":14},"end":{"line":104,"column":34}},{"start":{"line":104,"column":38},"end":{"line":104,"column":64}}],"line":104}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":17,"10":17,"11":17,"12":0,"13":0,"14":17,"15":11,"16":6,"17":4,"18":11,"19":11,"20":11,"21":11,"22":17,"23":0,"24":11,"25":3,"26":3,"27":3,"28":1,"29":3,"30":3,"31":3,"32":1,"33":2,"34":1,"35":2,"36":2,"37":2,"38":1,"39":4,"40":1,"41":4,"42":4,"43":4,"44":4,"45":0,"46":1,"47":2,"48":1,"49":2,"50":2,"51":2,"52":1},"f":{"0":17,"1":4,"2":11,"3":11,"4":17,"5":0,"6":3,"7":3,"8":1,"9":3,"10":2,"11":1,"12":2,"13":4,"14":1,"15":4,"16":2,"17":1,"18":2},"b":{"0":[11,6],"1":[3,0],"2":[3,3],"3":[2,1],"4":[3,2],"5":[0,2],"6":[2,0],"7":[3,1],"8":[4,3],"9":[0,2],"10":[2,0]},"inputSourceMap":{"version":3,"sources":["signing.ts"],"names":["encodeSignature","sig","enc","Buffer","from","toDER","signMessage","msgHash","key","sign","signTransaction","tx","verifySignature","msg","signature","verify","e","Error","verifyTxSignature"],"mappings":";;;;;;;;;;;AACA;;AACA;;AACA;;;;;;AAEA;AACA;AACA;AACA;AACO,SAASA,eAAT,CAAyBC,GAAzB,EAAkF;AAAA,MAAtCC,GAAsC,uEAAlB,QAAkB;AACrF,SAAO,0BAAaC,eAAOC,IAAP,CAAYH,GAAG,CAACI,KAAJ,EAAZ,CAAb,EAAuCH,GAAvC,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;AACA;;;SACsBI,W;;;AAKtB;AACA;AACA;AACA;AACA;;;;mCATO,WAA2BC,OAA3B,EAA4CC,GAA5C,EAA4G;AAAA,QAA/CN,GAA+C,uEAA3B,QAA2B;AAC/G,QAAMD,GAAG,GAAGO,GAAG,CAACC,IAAJ,CAASF,OAAT,CAAZ;AACA,WAAOP,eAAe,CAACC,GAAD,EAAMC,GAAN,CAAtB;AACH,G;;;;SAOqBQ,e;;;AAKtB;AACA;AACA;AACA;;;;uCARO,WAA+BC,EAA/B,EAAwCH,GAAxC,EAAwG;AAAA,QAA/CN,GAA+C,uEAA3B,QAA2B;AAC3G,QAAMK,OAAO,SAAS,8BAAgBI,EAAhB,EAAoB,OAApB,EAA6B,KAA7B,CAAtB;AACA,WAAOL,WAAW,CAACC,OAAD,EAAUC,GAAV,EAAeN,GAAf,CAAlB;AACH,G;;;;SAMqBU,e;;;AAUtB;AACA;AACA;;;;uCAZO,WAA+BC,GAA/B,EAA4CL,GAA5C,EAA6DM,SAA7D,EAAgI;AAAA,QAAhDZ,GAAgD,uEAA5B,QAA4B;;AACnI,QAAI;AACA,UAAMO,IAAI,GAAG,2BAAcK,SAAd,EAAyBZ,GAAzB,CAAb,CADA,CAEA;;AACA,aAAOM,GAAG,CAACO,MAAJ,CAAWF,GAAX,EAAgBJ,IAAhB,CAAP;AACH,KAJD,CAIE,OAAOO,CAAP,EAAU;AACR,YAAMC,KAAK,CAAC,iCAAiCD,CAAlC,CAAX;AACH;AACJ,G;;;;SAKqBE,iB;;;;;yCAAf,WAAiCP,EAAjC,EAA0CH,GAA1C,EAA2DM,SAA3D,EAA8H;AAAA,QAAhDZ,GAAgD,uEAA5B,QAA4B;AACjI,QAAMW,GAAG,SAAS,8BAAgBF,EAAhB,EAAoB,OAApB,EAA6B,KAA7B,CAAlB;AACA,iBAAaC,eAAe,CAACC,GAAD,EAAML,GAAN,EAAWM,SAAX,EAAsBZ,GAAtB,CAA5B;AACH,G","sourceRoot":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/","sourcesContent":["import { ec } from 'elliptic';\nimport { hashTransaction } from './hashing';\nimport { Buffer } from 'buffer';\nimport { encodeBuffer, decodeToBytes, ByteEncoding } from '@herajs/common';\n\n/**\n * Returns signature encoded in DER format in base64.\n * @param sig \n */\nexport function encodeSignature(sig: ec.Signature, enc: ByteEncoding = 'base64'): string {\n    return encodeBuffer(Buffer.from(sig.toDER()), enc);\n}\n\n/**\n * Sign transaction with key.\n * @param {Buffer} msgHash hash of a message. Can technically be any Buffer,\n *                         but it really is only secure if using a hash.\n * @param {BN} key key pair or private key\n */\nexport async function signMessage(msgHash: Buffer, key: ec.KeyPair, enc: ByteEncoding = 'base64'): Promise<string> {\n    const sig = key.sign(msgHash);\n    return encodeSignature(sig, enc);\n}\n\n/**\n * Sign transaction with key.\n * @param {object} tx transaction\n * @param {BN} key key pair or private key\n */\nexport async function signTransaction(tx: any, key: ec.KeyPair, enc: ByteEncoding = 'base64'): Promise<string> {\n    const msgHash = await hashTransaction(tx, 'bytes', false) as Buffer;\n    return signMessage(msgHash, key, enc);\n}\n\n/**\n * Verify that a signature for msg was generated by key\n * @param key key pair or public key\n */\nexport async function verifySignature(msg: Buffer, key: ec.KeyPair, signature: string, enc: ByteEncoding = 'base64'): Promise<boolean> {\n    try {\n        const sign = decodeToBytes(signature, enc);\n        // @ts-ignore: the typedef is wrong, a Buffer is an allowed input here\n        return key.verify(msg, sign);\n    } catch (e) {\n        throw Error('could not decode signature: ' + e);\n    }\n}\n\n/**\n * Verify that a signature for tx was generated by key\n */\nexport async function verifyTxSignature(tx: any, key: ec.KeyPair, signature: string, enc: ByteEncoding = 'base64'): Promise<boolean> {\n    const msg = await hashTransaction(tx, 'bytes', false) as Buffer;\n    return await verifySignature(msg, key, signature, enc);\n}\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1cad3d173a892a874b7248152d9d62133abd6bb9","contentHash":"e3a24538d868eae37237979efd33e4be1ee9efa6531e16b3dd1784c210abb272"},"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/hashing.ts":{"path":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/hashing.ts","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":20}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":42}},"3":{"start":{"line":9,"column":16},"end":{"line":9,"column":37}},"4":{"start":{"line":11,"column":14},"end":{"line":11,"column":39}},"5":{"start":{"line":13,"column":14},"end":{"line":13,"column":31}},"6":{"start":{"line":15,"column":13},"end":{"line":15,"column":31}},"7":{"start":{"line":17,"column":77},"end":{"line":17,"column":175}},"8":{"start":{"line":17,"column":94},"end":{"line":17,"column":107}},"9":{"start":{"line":17,"column":121},"end":{"line":17,"column":131}},"10":{"start":{"line":17,"column":151},"end":{"line":17,"column":165}},"11":{"start":{"line":17,"column":166},"end":{"line":17,"column":173}},"12":{"start":{"line":17,"column":176},"end":{"line":17,"column":263}},"13":{"start":{"line":17,"column":193},"end":{"line":17,"column":208}},"14":{"start":{"line":17,"column":218},"end":{"line":17,"column":261}},"15":{"start":{"line":19,"column":33},"end":{"line":19,"column":387}},"16":{"start":{"line":19,"column":65},"end":{"line":19,"column":69}},"17":{"start":{"line":19,"column":78},"end":{"line":19,"column":87}},"18":{"start":{"line":19,"column":89},"end":{"line":19,"column":384}},"19":{"start":{"line":19,"column":147},"end":{"line":19,"column":167}},"20":{"start":{"line":19,"column":193},"end":{"line":19,"column":264}},"21":{"start":{"line":19,"column":290},"end":{"line":19,"column":360}},"22":{"start":{"line":19,"column":363},"end":{"line":19,"column":380}},"23":{"start":{"line":22,"column":2},"end":{"line":24,"column":3}},"24":{"start":{"line":23,"column":4},"end":{"line":23,"column":55}},"25":{"start":{"line":26,"column":2},"end":{"line":28,"column":3}},"26":{"start":{"line":27,"column":4},"end":{"line":27,"column":30}},"27":{"start":{"line":30,"column":2},"end":{"line":30,"column":15}},"28":{"start":{"line":39,"column":10},"end":{"line":39,"column":29}},"29":{"start":{"line":41,"column":2},"end":{"line":41,"column":17}},"30":{"start":{"line":42,"column":2},"end":{"line":42,"column":41}},"31":{"start":{"line":54,"column":2},"end":{"line":56,"column":3}},"32":{"start":{"line":55,"column":4},"end":{"line":55,"column":13}},"33":{"start":{"line":58,"column":2},"end":{"line":60,"column":3}},"34":{"start":{"line":59,"column":4},"end":{"line":59,"column":13}},"35":{"start":{"line":62,"column":2},"end":{"line":62,"column":11}},"36":{"start":{"line":73,"column":2},"end":{"line":73,"column":49}},"37":{"start":{"line":77,"column":2},"end":{"line":121,"column":5}},"38":{"start":{"line":78,"column":19},"end":{"line":78,"column":95}},"39":{"start":{"line":79,"column":22},"end":{"line":79,"column":94}},"40":{"start":{"line":81,"column":17},"end":{"line":81,"column":20}},"41":{"start":{"line":83,"column":4},"end":{"line":101,"column":5}},"42":{"start":{"line":84,"column":22},"end":{"line":84,"column":49}},"43":{"start":{"line":86,"column":6},"end":{"line":100,"column":7}},"44":{"start":{"line":88,"column":25},"end":{"line":88,"column":59}},"45":{"start":{"line":90,"column":8},"end":{"line":92,"column":9}},"46":{"start":{"line":91,"column":10},"end":{"line":91,"column":141}},"47":{"start":{"line":95,"column":8},"end":{"line":95,"column":50}},"48":{"start":{"line":97,"column":8},"end":{"line":99,"column":9}},"49":{"start":{"line":98,"column":10},"end":{"line":98,"column":93}},"50":{"start":{"line":103,"column":15},"end":{"line":103,"column":71}},"51":{"start":{"line":104,"column":16},"end":{"line":106,"column":6}},"52":{"start":{"line":105,"column":6},"end":{"line":105,"column":39}},"53":{"start":{"line":108,"column":15},"end":{"line":108,"column":43}},"54":{"start":{"line":110,"column":4},"end":{"line":112,"column":5}},"55":{"start":{"line":111,"column":6},"end":{"line":111,"column":83}},"56":{"start":{"line":114,"column":17},"end":{"line":114,"column":27}},"57":{"start":{"line":116,"column":4},"end":{"line":118,"column":5}},"58":{"start":{"line":117,"column":6},"end":{"line":117,"column":20}},"59":{"start":{"line":120,"column":4},"end":{"line":120,"column":55}},"60":{"start":{"line":122,"column":2},"end":{"line":122,"column":49}}},"fnMap":{"0":{"name":"asyncGeneratorStep","decl":{"start":{"line":17,"column":9},"end":{"line":17,"column":27}},"loc":{"start":{"line":17,"column":75},"end":{"line":17,"column":265}},"line":17},"1":{"name":"_asyncToGenerator","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":26}},"loc":{"start":{"line":19,"column":31},"end":{"line":19,"column":389}},"line":19},"2":{"name":"(anonymous_2)","decl":{"start":{"line":19,"column":40},"end":{"line":19,"column":41}},"loc":{"start":{"line":19,"column":52},"end":{"line":19,"column":386}},"line":19},"3":{"name":"(anonymous_3)","decl":{"start":{"line":19,"column":108},"end":{"line":19,"column":109}},"loc":{"start":{"line":19,"column":135},"end":{"line":19,"column":382}},"line":19},"4":{"name":"_next","decl":{"start":{"line":19,"column":178},"end":{"line":19,"column":183}},"loc":{"start":{"line":19,"column":191},"end":{"line":19,"column":266}},"line":19},"5":{"name":"_throw","decl":{"start":{"line":19,"column":276},"end":{"line":19,"column":282}},"loc":{"start":{"line":19,"column":288},"end":{"line":19,"column":362}},"line":19},"6":{"name":"bufferOrB58","decl":{"start":{"line":21,"column":9},"end":{"line":21,"column":20}},"loc":{"start":{"line":21,"column":28},"end":{"line":31,"column":1}},"line":21},"7":{"name":"hash","decl":{"start":{"line":38,"column":9},"end":{"line":38,"column":13}},"loc":{"start":{"line":38,"column":20},"end":{"line":43,"column":1}},"line":38},"8":{"name":"inferType","decl":{"start":{"line":53,"column":9},"end":{"line":53,"column":18}},"loc":{"start":{"line":53,"column":23},"end":{"line":63,"column":1}},"line":53},"9":{"name":"hashTransaction","decl":{"start":{"line":72,"column":9},"end":{"line":72,"column":24}},"loc":{"start":{"line":72,"column":29},"end":{"line":74,"column":1}},"line":72},"10":{"name":"_hashTransaction","decl":{"start":{"line":76,"column":9},"end":{"line":76,"column":25}},"loc":{"start":{"line":76,"column":28},"end":{"line":123,"column":1}},"line":76},"11":{"name":"(anonymous_11)","decl":{"start":{"line":77,"column":39},"end":{"line":77,"column":40}},"loc":{"start":{"line":77,"column":54},"end":{"line":121,"column":3}},"line":77},"12":{"name":"(anonymous_12)","decl":{"start":{"line":104,"column":507},"end":{"line":104,"column":508}},"loc":{"start":{"line":104,"column":523},"end":{"line":106,"column":5}},"line":104}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":176},"end":{"line":17,"column":263}},"type":"if","locations":[{"start":{"line":17,"column":176},"end":{"line":17,"column":263}},{"start":{"line":17,"column":176},"end":{"line":17,"column":263}}],"line":17},"1":{"loc":{"start":{"line":22,"column":2},"end":{"line":24,"column":3}},"type":"if","locations":[{"start":{"line":22,"column":2},"end":{"line":24,"column":3}},{"start":{"line":22,"column":2},"end":{"line":24,"column":3}}],"line":22},"2":{"loc":{"start":{"line":26,"column":2},"end":{"line":28,"column":3}},"type":"if","locations":[{"start":{"line":26,"column":2},"end":{"line":28,"column":3}},{"start":{"line":26,"column":2},"end":{"line":28,"column":3}}],"line":26},"3":{"loc":{"start":{"line":54,"column":2},"end":{"line":56,"column":3}},"type":"if","locations":[{"start":{"line":54,"column":2},"end":{"line":56,"column":3}},{"start":{"line":54,"column":2},"end":{"line":56,"column":3}}],"line":54},"4":{"loc":{"start":{"line":58,"column":2},"end":{"line":60,"column":3}},"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":60,"column":3}},{"start":{"line":58,"column":2},"end":{"line":60,"column":3}}],"line":58},"5":{"loc":{"start":{"line":58,"column":6},"end":{"line":58,"column":84}},"type":"binary-expr","locations":[{"start":{"line":58,"column":6},"end":{"line":58,"column":41}},{"start":{"line":58,"column":45},"end":{"line":58,"column":84}}],"line":58},"6":{"loc":{"start":{"line":78,"column":19},"end":{"line":78,"column":95}},"type":"cond-expr","locations":[{"start":{"line":78,"column":72},"end":{"line":78,"column":84}},{"start":{"line":78,"column":87},"end":{"line":78,"column":95}}],"line":78},"7":{"loc":{"start":{"line":78,"column":19},"end":{"line":78,"column":69}},"type":"binary-expr","locations":[{"start":{"line":78,"column":19},"end":{"line":78,"column":39}},{"start":{"line":78,"column":43},"end":{"line":78,"column":69}}],"line":78},"8":{"loc":{"start":{"line":79,"column":22},"end":{"line":79,"column":94}},"type":"cond-expr","locations":[{"start":{"line":79,"column":75},"end":{"line":79,"column":87}},{"start":{"line":79,"column":90},"end":{"line":79,"column":94}}],"line":79},"9":{"loc":{"start":{"line":79,"column":22},"end":{"line":79,"column":72}},"type":"binary-expr","locations":[{"start":{"line":79,"column":22},"end":{"line":79,"column":42}},{"start":{"line":79,"column":46},"end":{"line":79,"column":72}}],"line":79},"10":{"loc":{"start":{"line":83,"column":4},"end":{"line":101,"column":5}},"type":"if","locations":[{"start":{"line":83,"column":4},"end":{"line":101,"column":5}},{"start":{"line":83,"column":4},"end":{"line":101,"column":5}}],"line":83},"11":{"loc":{"start":{"line":86,"column":6},"end":{"line":100,"column":7}},"type":"if","locations":[{"start":{"line":86,"column":6},"end":{"line":100,"column":7}},{"start":{"line":86,"column":6},"end":{"line":100,"column":7}}],"line":86},"12":{"loc":{"start":{"line":90,"column":8},"end":{"line":92,"column":9}},"type":"if","locations":[{"start":{"line":90,"column":8},"end":{"line":92,"column":9}},{"start":{"line":90,"column":8},"end":{"line":92,"column":9}}],"line":90},"13":{"loc":{"start":{"line":90,"column":12},"end":{"line":90,"column":49}},"type":"binary-expr","locations":[{"start":{"line":90,"column":12},"end":{"line":90,"column":22}},{"start":{"line":90,"column":26},"end":{"line":90,"column":49}}],"line":90},"14":{"loc":{"start":{"line":97,"column":8},"end":{"line":99,"column":9}},"type":"if","locations":[{"start":{"line":97,"column":8},"end":{"line":99,"column":9}},{"start":{"line":97,"column":8},"end":{"line":99,"column":9}}],"line":97},"15":{"loc":{"start":{"line":103,"column":15},"end":{"line":103,"column":71}},"type":"cond-expr","locations":[{"start":{"line":103,"column":48},"end":{"line":103,"column":55}},{"start":{"line":103,"column":58},"end":{"line":103,"column":71}}],"line":103},"16":{"loc":{"start":{"line":104,"column":112},"end":{"line":104,"column":192}},"type":"cond-expr","locations":[{"start":{"line":104,"column":120},"end":{"line":104,"column":166}},{"start":{"line":104,"column":169},"end":{"line":104,"column":192}}],"line":104},"17":{"loc":{"start":{"line":104,"column":220},"end":{"line":104,"column":245}},"type":"cond-expr","locations":[{"start":{"line":104,"column":235},"end":{"line":104,"column":241}},{"start":{"line":104,"column":244},"end":{"line":104,"column":245}}],"line":104},"18":{"loc":{"start":{"line":104,"column":248},"end":{"line":104,"column":318}},"type":"cond-expr","locations":[{"start":{"line":104,"column":261},"end":{"line":104,"column":292}},{"start":{"line":104,"column":295},"end":{"line":104,"column":318}}],"line":104},"19":{"loc":{"start":{"line":104,"column":346},"end":{"line":104,"column":359}},"type":"binary-expr","locations":[{"start":{"line":104,"column":346},"end":{"line":104,"column":354}},{"start":{"line":104,"column":358},"end":{"line":104,"column":359}}],"line":104},"20":{"loc":{"start":{"line":104,"column":396},"end":{"line":104,"column":430}},"type":"cond-expr","locations":[{"start":{"line":104,"column":407},"end":{"line":104,"column":426}},{"start":{"line":104,"column":429},"end":{"line":104,"column":430}}],"line":104},"21":{"loc":{"start":{"line":110,"column":4},"end":{"line":112,"column":5}},"type":"if","locations":[{"start":{"line":110,"column":4},"end":{"line":112,"column":5}},{"start":{"line":110,"column":4},"end":{"line":112,"column":5}}],"line":110},"22":{"loc":{"start":{"line":110,"column":8},"end":{"line":110,"column":53}},"type":"binary-expr","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":19}},{"start":{"line":110,"column":23},"end":{"line":110,"column":53}}],"line":110},"23":{"loc":{"start":{"line":116,"column":4},"end":{"line":118,"column":5}},"type":"if","locations":[{"start":{"line":116,"column":4},"end":{"line":118,"column":5}},{"start":{"line":116,"column":4},"end":{"line":118,"column":5}}],"line":116}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":25,"8":25,"9":18,"10":7,"11":7,"12":18,"13":18,"14":0,"15":1,"16":25,"17":25,"18":25,"19":25,"20":25,"21":0,"22":25,"23":18,"24":16,"25":2,"26":2,"27":0,"28":23,"29":23,"30":23,"31":16,"32":11,"33":5,"34":0,"35":5,"36":25,"37":1,"38":25,"39":25,"40":25,"41":25,"42":20,"43":20,"44":19,"45":19,"46":4,"47":15,"48":15,"49":3,"50":18,"51":18,"52":162,"53":18,"54":18,"55":1,"56":18,"57":18,"58":4,"59":14,"60":1},"f":{"0":25,"1":1,"2":25,"3":25,"4":25,"5":0,"6":18,"7":23,"8":16,"9":25,"10":1,"11":25,"12":162},"b":{"0":[18,0],"1":[16,2],"2":[2,0],"3":[11,5],"4":[0,5],"5":[5,5],"6":[6,19],"7":[25,6],"8":[4,21],"9":[25,4],"10":[20,5],"11":[19,1],"12":[4,15],"13":[19,18],"14":[3,12],"15":[2,16],"16":[5,13],"17":[18,0],"18":[0,18],"19":[18,18],"20":[0,18],"21":[1,17],"22":[18,14],"23":[4,14]},"inputSourceMap":{"version":3,"sources":["hashing.ts"],"names":["bufferOrB58","input","Uint8Array","hash","data","h","ecdsa","update","Buffer","from","digest","inferType","tx","to","hashTransaction","encoding","includeSign","amount","amountStr","toString","trim","amountUnit","match","Error","replace","type","items","nonce","payload","limit","price","chainIdHash","map","item","concat","sign","result"],"mappings":"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","sourceRoot":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/","sourcesContent":["import { fromNumber, fromBigInt, decodeAddress } from './encoding';\nimport { encodeBuffer, decodeToBytes, ByteEncoding } from '@herajs/common';\nimport JSBI from 'jsbi';\nimport { Buffer } from 'buffer';\nimport { ecdsa } from './ecdsa';\n\nfunction bufferOrB58(input?: Uint8Array | string): Uint8Array {\n    if (typeof input === 'string') {\n        return decodeToBytes(input, 'base58');\n    }\n    if (typeof input === 'undefined') {\n        return new Uint8Array([]);\n    }\n    return input;\n}\n\ninterface StringCovertible {\n    toString(): string;\n}\n\n/**\n * Calculate hash of transaction\n * @param {object} tx Transaction\n * @return {Buffer} transaction hash\n */\nexport function hash(data: Buffer): Buffer {\n    const h = ecdsa.hash();\n    h.update(data);\n    return Buffer.from(h.digest());\n}\n\n/**\n * Transaction body.\n * All fields except nonce, from, and chainIdHash are optional and will assume sensible defaults.\n */\nexport interface TxBody {\n    nonce: number;\n    from: string | StringCovertible;\n    chainIdHash: Uint8Array | string;\n    amount?: string | number | JSBI | StringCovertible;\n    to?: null | string | StringCovertible;\n    payload?: null | string | Uint8Array;\n    limit?: number;\n    price?: string | number | JSBI | StringCovertible;\n    type?: number;\n    sign?: string;\n}\n\n/**\n * Infer a tx type based on body. Can be overriden by exlicitly passing type.\n */\nfunction inferType(tx: TxBody): number {\n    if (!tx.to) {\n        return 6;\n    }\n    if (`${tx.to}` === 'aergo.system' || `${tx.to}` === 'aergo.enterprise') {\n        return 1;\n    }\n    return 0;\n}\n\n/**\n * Calculate hash of transaction\n * @param {object} tx Transaction\n * @param {ByteEncoding} encoding bytes (default), base58, base64\n * @return {Buffer | string} transaction hash. If encoding is bytes, the result is a Buffer, otherwise a string.\n */\nexport async function hashTransaction(tx: TxBody): Promise<string>;\nexport async function hashTransaction(tx: TxBody, encoding: ByteEncoding, includeSign?: boolean): Promise<string>;\nexport async function hashTransaction(tx: TxBody, encoding: 'bytes', includeSign?: boolean): Promise<Buffer>;\nexport async function hashTransaction(tx: TxBody, encoding: ByteEncoding | 'bytes' = 'base64', includeSign = true): Promise<Buffer | string> {\n    // Amount defaults to zero if tx.amount is falsy\n    let amount = '0';\n    if (tx.amount) {\n        const amountStr = tx.amount.toString().trim();\n        if (amountStr !== '') {\n            // Throw error if unit is given other than aer\n            const amountUnit = amountStr.match(/\\s*([^0-9]+)\\s*/);\n            if (amountUnit && amountUnit[1] !== 'aer') {\n                throw Error(`Can only hash amounts provided in the base unit (aer), not '${tx.amount}'. Convert to aer or remove unit.`);\n            }\n            // Strip unit\n            amount = amountStr.replace(/[^0-9]/g,'');\n            // Throw error if amount is an empty string at this point (amount with unit but without value)\n            if (amount === '') {\n                throw Error(`Could not parse numeric value from amount '${tx.amount}'.`);\n            }\n        }\n    }\n    const type = typeof tx.type !== 'undefined' ? tx.type : inferType(tx);\n\n    const items = [\n        fromNumber(tx.nonce, 64/8),\n        decodeAddress(tx.from.toString()),\n        tx.to ? decodeAddress(tx.to.toString()) : Buffer.from([]),\n        fromBigInt(amount!= '' ? amount : 0),\n        tx.payload ? Buffer.from(tx.payload as any) : Buffer.from([]),\n        fromNumber(tx.limit || 0, 64/8),\n        fromBigInt(tx.price ? tx.price.toString() : 0),\n        fromNumber(type, 32/8),\n        bufferOrB58(tx.chainIdHash),\n    ].map(item => Buffer.from(item));\n\n    let data = Buffer.concat(items);\n\n    if (includeSign && typeof tx.sign !== 'undefined') {\n        data = Buffer.concat([data, Buffer.from(tx.sign, 'base64')]);\n    }\n\n    const result = hash(data);\n    if (encoding === 'bytes') {\n        return result;\n    }\n    return encodeBuffer(result, encoding);\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"19d42d8af8e94f4ec1a662ea27fad5332fc3d390","contentHash":"59b09f46808cea3ff96ae51eab5deea658c78366a582b7675ecfd940882f0da6"},"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/seed.ts":{"path":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/seed.ts","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":44}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":40}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":56}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":48}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":58}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":50}},"7":{"start":{"line":12,"column":0},"end":{"line":17,"column":3}},"8":{"start":{"line":15,"column":4},"end":{"line":15,"column":33}},"9":{"start":{"line":19,"column":13},"end":{"line":19,"column":61}},"10":{"start":{"line":21,"column":14},"end":{"line":21,"column":39}},"11":{"start":{"line":23,"column":11},"end":{"line":23,"column":27}},"12":{"start":{"line":25,"column":39},"end":{"line":25,"column":95}},"13":{"start":{"line":27,"column":77},"end":{"line":27,"column":175}},"14":{"start":{"line":27,"column":94},"end":{"line":27,"column":107}},"15":{"start":{"line":27,"column":121},"end":{"line":27,"column":131}},"16":{"start":{"line":27,"column":151},"end":{"line":27,"column":165}},"17":{"start":{"line":27,"column":166},"end":{"line":27,"column":173}},"18":{"start":{"line":27,"column":176},"end":{"line":27,"column":263}},"19":{"start":{"line":27,"column":193},"end":{"line":27,"column":208}},"20":{"start":{"line":27,"column":218},"end":{"line":27,"column":261}},"21":{"start":{"line":29,"column":33},"end":{"line":29,"column":387}},"22":{"start":{"line":29,"column":65},"end":{"line":29,"column":69}},"23":{"start":{"line":29,"column":78},"end":{"line":29,"column":87}},"24":{"start":{"line":29,"column":89},"end":{"line":29,"column":384}},"25":{"start":{"line":29,"column":147},"end":{"line":29,"column":167}},"26":{"start":{"line":29,"column":193},"end":{"line":29,"column":264}},"27":{"start":{"line":29,"column":290},"end":{"line":29,"column":360}},"28":{"start":{"line":29,"column":363},"end":{"line":29,"column":380}},"29":{"start":{"line":31,"column":54},"end":{"line":31,"column":73}},"30":{"start":{"line":31,"column":75},"end":{"line":31,"column":326}},"31":{"start":{"line":31,"column":125},"end":{"line":31,"column":161}},"32":{"start":{"line":31,"column":163},"end":{"line":31,"column":324}},"33":{"start":{"line":31,"column":224},"end":{"line":31,"column":287}},"34":{"start":{"line":31,"column":327},"end":{"line":31,"column":339}},"35":{"start":{"line":33,"column":33},"end":{"line":33,"column":489}},"36":{"start":{"line":33,"column":46},"end":{"line":33,"column":47}},"37":{"start":{"line":33,"column":91},"end":{"line":33,"column":131}},"38":{"start":{"line":33,"column":133},"end":{"line":33,"column":487}},"39":{"start":{"line":33,"column":194},"end":{"line":33,"column":236}},"40":{"start":{"line":33,"column":402},"end":{"line":33,"column":483}},"41":{"start":{"line":33,"column":490},"end":{"line":33,"column":504}},"42":{"start":{"line":35,"column":44},"end":{"line":35,"column":195}},"43":{"start":{"line":35,"column":62},"end":{"line":35,"column":166}},"44":{"start":{"line":35,"column":176},"end":{"line":35,"column":193}},"45":{"start":{"line":35,"column":196},"end":{"line":35,"column":207}},"46":{"start":{"line":44,"column":2},"end":{"line":44,"column":61}},"47":{"start":{"line":54,"column":2},"end":{"line":54,"column":54}},"48":{"start":{"line":61,"column":21},"end":{"line":64,"column":1}},"49":{"start":{"line":72,"column":16},"end":{"line":72,"column":86}},"50":{"start":{"line":74,"column":13},"end":{"line":74,"column":59}},"51":{"start":{"line":76,"column":17},"end":{"line":76,"column":55}},"52":{"start":{"line":78,"column":20},"end":{"line":78,"column":22}},"53":{"start":{"line":80,"column":2},"end":{"line":83,"column":3}},"54":{"start":{"line":80,"column":15},"end":{"line":80,"column":16}},"55":{"start":{"line":81,"column":14},"end":{"line":81,"column":46}},"56":{"start":{"line":82,"column":4},"end":{"line":82,"column":37}},"57":{"start":{"line":85,"column":2},"end":{"line":85,"column":21}},"58":{"start":{"line":95,"column":2},"end":{"line":95,"column":52}},"59":{"start":{"line":105,"column":2},"end":{"line":108,"column":5}},"60":{"start":{"line":106,"column":18},"end":{"line":106,"column":88}},"61":{"start":{"line":107,"column":4},"end":{"line":107,"column":49}},"62":{"start":{"line":109,"column":2},"end":{"line":109,"column":52}},"63":{"start":{"line":113,"column":2},"end":{"line":113,"column":57}},"64":{"start":{"line":123,"column":2},"end":{"line":127,"column":5}},"65":{"start":{"line":124,"column":18},"end":{"line":124,"column":88}},"66":{"start":{"line":125,"column":15},"end":{"line":125,"column":45}},"67":{"start":{"line":126,"column":4},"end":{"line":126,"column":46}},"68":{"start":{"line":128,"column":2},"end":{"line":128,"column":57}},"69":{"start":{"line":132,"column":2},"end":{"line":132,"column":56}},"70":{"start":{"line":136,"column":2},"end":{"line":139,"column":5}},"71":{"start":{"line":137,"column":18},"end":{"line":137,"column":88}},"72":{"start":{"line":138,"column":4},"end":{"line":138,"column":65}},"73":{"start":{"line":140,"column":2},"end":{"line":140,"column":56}}},"fnMap":{"0":{"name":"get","decl":{"start":{"line":14,"column":16},"end":{"line":14,"column":19}},"loc":{"start":{"line":14,"column":22},"end":{"line":16,"column":3}},"line":14},"1":{"name":"_interopRequireDefault","decl":{"start":{"line":25,"column":9},"end":{"line":25,"column":31}},"loc":{"start":{"line":25,"column":37},"end":{"line":25,"column":97}},"line":25},"2":{"name":"asyncGeneratorStep","decl":{"start":{"line":27,"column":9},"end":{"line":27,"column":27}},"loc":{"start":{"line":27,"column":75},"end":{"line":27,"column":265}},"line":27},"3":{"name":"_asyncToGenerator","decl":{"start":{"line":29,"column":9},"end":{"line":29,"column":26}},"loc":{"start":{"line":29,"column":31},"end":{"line":29,"column":389}},"line":29},"4":{"name":"(anonymous_4)","decl":{"start":{"line":29,"column":40},"end":{"line":29,"column":41}},"loc":{"start":{"line":29,"column":52},"end":{"line":29,"column":386}},"line":29},"5":{"name":"(anonymous_5)","decl":{"start":{"line":29,"column":108},"end":{"line":29,"column":109}},"loc":{"start":{"line":29,"column":135},"end":{"line":29,"column":382}},"line":29},"6":{"name":"_next","decl":{"start":{"line":29,"column":178},"end":{"line":29,"column":183}},"loc":{"start":{"line":29,"column":191},"end":{"line":29,"column":266}},"line":29},"7":{"name":"_throw","decl":{"start":{"line":29,"column":276},"end":{"line":29,"column":282}},"loc":{"start":{"line":29,"column":288},"end":{"line":29,"column":362}},"line":29},"8":{"name":"ownKeys","decl":{"start":{"line":31,"column":9},"end":{"line":31,"column":16}},"loc":{"start":{"line":31,"column":41},"end":{"line":31,"column":341}},"line":31},"9":{"name":"(anonymous_9)","decl":{"start":{"line":31,"column":207},"end":{"line":31,"column":208}},"loc":{"start":{"line":31,"column":222},"end":{"line":31,"column":289}},"line":31},"10":{"name":"_objectSpread","decl":{"start":{"line":33,"column":9},"end":{"line":33,"column":22}},"loc":{"start":{"line":33,"column":31},"end":{"line":33,"column":506}},"line":33},"11":{"name":"(anonymous_11)","decl":{"start":{"line":33,"column":177},"end":{"line":33,"column":178}},"loc":{"start":{"line":33,"column":192},"end":{"line":33,"column":238}},"line":33},"12":{"name":"(anonymous_12)","decl":{"start":{"line":33,"column":385},"end":{"line":33,"column":386}},"loc":{"start":{"line":33,"column":400},"end":{"line":33,"column":485}},"line":33},"13":{"name":"_defineProperty","decl":{"start":{"line":35,"column":9},"end":{"line":35,"column":24}},"loc":{"start":{"line":35,"column":42},"end":{"line":35,"column":209}},"line":35},"14":{"name":"generateMnemonic","decl":{"start":{"line":43,"column":9},"end":{"line":43,"column":25}},"loc":{"start":{"line":43,"column":51},"end":{"line":45,"column":1}},"line":43},"15":{"name":"mnemonicToSeed","decl":{"start":{"line":53,"column":9},"end":{"line":53,"column":23}},"loc":{"start":{"line":53,"column":44},"end":{"line":55,"column":1}},"line":53},"16":{"name":"privateKeysFromSeed","decl":{"start":{"line":71,"column":9},"end":{"line":71,"column":28}},"loc":{"start":{"line":71,"column":35},"end":{"line":86,"column":1}},"line":71},"17":{"name":"privateKeyFromSeed","decl":{"start":{"line":94,"column":9},"end":{"line":94,"column":27}},"loc":{"start":{"line":94,"column":32},"end":{"line":96,"column":1}},"line":94},"18":{"name":"_privateKeyFromSeed","decl":{"start":{"line":104,"column":9},"end":{"line":104,"column":28}},"loc":{"start":{"line":104,"column":31},"end":{"line":110,"column":1}},"line":104},"19":{"name":"(anonymous_19)","decl":{"start":{"line":105,"column":42},"end":{"line":105,"column":43}},"loc":{"start":{"line":105,"column":59},"end":{"line":108,"column":3}},"line":105},"20":{"name":"privateKeysFromMnemonic","decl":{"start":{"line":112,"column":9},"end":{"line":112,"column":32}},"loc":{"start":{"line":112,"column":38},"end":{"line":114,"column":1}},"line":112},"21":{"name":"_privateKeysFromMnemonic","decl":{"start":{"line":122,"column":9},"end":{"line":122,"column":33}},"loc":{"start":{"line":122,"column":36},"end":{"line":129,"column":1}},"line":122},"22":{"name":"(anonymous_22)","decl":{"start":{"line":123,"column":47},"end":{"line":123,"column":48}},"loc":{"start":{"line":123,"column":68},"end":{"line":127,"column":3}},"line":123},"23":{"name":"privateKeyFromMnemonic","decl":{"start":{"line":131,"column":9},"end":{"line":131,"column":31}},"loc":{"start":{"line":131,"column":37},"end":{"line":133,"column":1}},"line":131},"24":{"name":"_privateKeyFromMnemonic","decl":{"start":{"line":135,"column":9},"end":{"line":135,"column":32}},"loc":{"start":{"line":135,"column":35},"end":{"line":141,"column":1}},"line":135},"25":{"name":"(anonymous_25)","decl":{"start":{"line":136,"column":46},"end":{"line":136,"column":47}},"loc":{"start":{"line":136,"column":67},"end":{"line":139,"column":3}},"line":136}},"branchMap":{"0":{"loc":{"start":{"line":25,"column":46},"end":{"line":25,"column":94}},"type":"cond-expr","locations":[{"start":{"line":25,"column":70},"end":{"line":25,"column":73}},{"start":{"line":25,"column":76},"end":{"line":25,"column":94}}],"line":25},"1":{"loc":{"start":{"line":25,"column":46},"end":{"line":25,"column":67}},"type":"binary-expr","locations":[{"start":{"line":25,"column":46},"end":{"line":25,"column":49}},{"start":{"line":25,"column":53},"end":{"line":25,"column":67}}],"line":25},"2":{"loc":{"start":{"line":27,"column":176},"end":{"line":27,"column":263}},"type":"if","locations":[{"start":{"line":27,"column":176},"end":{"line":27,"column":263}},{"start":{"line":27,"column":176},"end":{"line":27,"column":263}}],"line":27},"3":{"loc":{"start":{"line":31,"column":75},"end":{"line":31,"column":326}},"type":"if","locations":[{"start":{"line":31,"column":75},"end":{"line":31,"column":326}},{"start":{"line":31,"column":75},"end":{"line":31,"column":326}}],"line":31},"4":{"loc":{"start":{"line":31,"column":163},"end":{"line":31,"column":291}},"type":"binary-expr","locations":[{"start":{"line":31,"column":163},"end":{"line":31,"column":177}},{"start":{"line":31,"column":182},"end":{"line":31,"column":290}}],"line":31},"5":{"loc":{"start":{"line":33,"column":91},"end":{"line":33,"column":131}},"type":"cond-expr","locations":[{"start":{"line":33,"column":114},"end":{"line":33,"column":126}},{"start":{"line":33,"column":129},"end":{"line":33,"column":131}}],"line":33},"6":{"loc":{"start":{"line":33,"column":133},"end":{"line":33,"column":486}},"type":"cond-expr","locations":[{"start":{"line":33,"column":141},"end":{"line":33,"column":239}},{"start":{"line":33,"column":242},"end":{"line":33,"column":486}}],"line":33},"7":{"loc":{"start":{"line":33,"column":242},"end":{"line":33,"column":486}},"type":"cond-expr","locations":[{"start":{"line":33,"column":277},"end":{"line":33,"column":350}},{"start":{"line":33,"column":353},"end":{"line":33,"column":486}}],"line":33},"8":{"loc":{"start":{"line":35,"column":44},"end":{"line":35,"column":195}},"type":"if","locations":[{"start":{"line":35,"column":44},"end":{"line":35,"column":195}},{"start":{"line":35,"column":44},"end":{"line":35,"column":195}}],"line":35},"9":{"loc":{"start":{"line":72,"column":16},"end":{"line":72,"column":86}},"type":"cond-expr","locations":[{"start":{"line":72,"column":69},"end":{"line":72,"column":81}},{"start":{"line":72,"column":84},"end":{"line":72,"column":86}}],"line":72},"10":{"loc":{"start":{"line":72,"column":16},"end":{"line":72,"column":66}},"type":"binary-expr","locations":[{"start":{"line":72,"column":16},"end":{"line":72,"column":36}},{"start":{"line":72,"column":40},"end":{"line":72,"column":66}}],"line":72},"11":{"loc":{"start":{"line":106,"column":18},"end":{"line":106,"column":88}},"type":"cond-expr","locations":[{"start":{"line":106,"column":71},"end":{"line":106,"column":83}},{"start":{"line":106,"column":86},"end":{"line":106,"column":88}}],"line":106},"12":{"loc":{"start":{"line":106,"column":18},"end":{"line":106,"column":68}},"type":"binary-expr","locations":[{"start":{"line":106,"column":18},"end":{"line":106,"column":38}},{"start":{"line":106,"column":42},"end":{"line":106,"column":68}}],"line":106},"13":{"loc":{"start":{"line":124,"column":18},"end":{"line":124,"column":88}},"type":"cond-expr","locations":[{"start":{"line":124,"column":71},"end":{"line":124,"column":83}},{"start":{"line":124,"column":86},"end":{"line":124,"column":88}}],"line":124},"14":{"loc":{"start":{"line":124,"column":18},"end":{"line":124,"column":68}},"type":"binary-expr","locations":[{"start":{"line":124,"column":18},"end":{"line":124,"column":38}},{"start":{"line":124,"column":42},"end":{"line":124,"column":68}}],"line":124},"15":{"loc":{"start":{"line":137,"column":18},"end":{"line":137,"column":88}},"type":"cond-expr","locations":[{"start":{"line":137,"column":71},"end":{"line":137,"column":83}},{"start":{"line":137,"column":86},"end":{"line":137,"column":88}}],"line":137},"16":{"loc":{"start":{"line":137,"column":18},"end":{"line":137,"column":68}},"type":"binary-expr","locations":[{"start":{"line":137,"column":18},"end":{"line":137,"column":38}},{"start":{"line":137,"column":42},"end":{"line":137,"column":68}}],"line":137}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":1,"10":1,"11":1,"12":1,"13":22,"14":22,"15":22,"16":0,"17":0,"18":22,"19":13,"20":9,"21":3,"22":13,"23":13,"24":13,"25":13,"26":22,"27":0,"28":13,"29":24,"30":24,"31":24,"32":24,"33":0,"34":24,"35":12,"36":12,"37":36,"38":36,"39":29,"40":0,"41":12,"42":29,"43":5,"44":24,"45":29,"46":1,"47":6,"48":1,"49":12,"50":12,"51":12,"52":12,"53":12,"54":12,"55":12,"56":12,"57":12,"58":4,"59":1,"60":4,"61":4,"62":1,"63":5,"64":1,"65":5,"66":5,"67":5,"68":1,"69":4,"70":1,"71":4,"72":4,"73":1},"f":{"0":2,"1":1,"2":22,"3":3,"4":13,"5":13,"6":22,"7":0,"8":24,"9":0,"10":12,"11":29,"12":0,"13":29,"14":1,"15":6,"16":12,"17":4,"18":1,"19":4,"20":5,"21":1,"22":5,"23":4,"24":1,"25":4},"b":{"0":[0,1],"1":[1,1],"2":[13,9],"3":[24,0],"4":[24,24],"5":[36,0],"6":[24,12],"7":[12,0],"8":[5,24],"9":[11,1],"10":[12,11],"11":[2,2],"12":[4,2],"13":[4,1],"14":[5,4],"15":[1,3],"16":[4,1]},"inputSourceMap":{"version":3,"sources":["seed.ts"],"names":["generateMnemonic","strength","rng","wordlist","mnemonicToSeed","mnemonic","password","defaultOptions","hdpath","constants","WALLET_HDPATH","count","privateKeysFromSeed","seed","options","opts","hdwallet","hdkey","fromMasterSeed","privateKeys","i","key","derive","push","privateKey","privateKeyFromSeed","privateKeysFromMnemonic","privateKeyFromMnemonic"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;AACA;;AAGA;;;;;;;;;;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,gBAAT,CAA0BC,QAA1B,EAA6CC,GAA7C,EAA6EC,QAA7E,EAA0G;AAC7G,SAAO,2BAAkBF,QAAlB,EAA4BC,GAA5B,EAAiCC,QAAjC,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;AACO,SAASC,cAAT,CAAwBC,QAAxB,EAA0CC,QAA1C,EAA8E;AACjF,SAAO,yBAAgBD,QAAhB,EAA0BC,QAA1B,CAAP;AACH;AAED;AACA;AACA;;;AAMA,IAAMC,cAAc,GAAG;AACnBC,EAAAA,MAAM,EAAEC,kBAAUC,aADC;AAEnBC,EAAAA,KAAK,EAAE;AAFY,CAAvB;AAKA;AACA;AACA;AACA;AACA;;AACO,SAASC,mBAAT,CAA6BC,IAA7B,EAA4E;AAAA,MAAjCC,OAAiC,uEAAd,EAAc;;AAC/E,MAAMC,IAAI,qBAAQR,cAAR,MAA2BO,OAA3B,CAAV;;AACA,MAAME,QAAQ,GAAGC,kBAAMC,cAAN,CAAqBL,IAArB,CAAjB;;AACA,MAAMM,WAAW,GAAG,EAApB;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,IAAI,CAACJ,KAAzB,EAAgCS,CAAC,EAAjC,EAAqC;AACjC,QAAMC,GAAG,GAAGL,QAAQ,CAACM,MAAT,CAAgBP,IAAI,CAACP,MAAL,GAAcY,CAA9B,CAAZ;AACAD,IAAAA,WAAW,CAACI,IAAZ,CAAiBF,GAAG,CAACG,UAArB;AACH;;AACD,SAAOL,WAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;SACsBM,kB;;;AAItB;AACA;AACA;AACA;AACA;;;;0CARO,WAAkCZ,IAAlC,EAAwF;AAAA,QAAxCC,OAAwC,uEAArB,EAAqB;AAC3F,WAAOF,mBAAmB,CAACC,IAAD,EAAOC,OAAP,CAAnB,CAAmC,CAAnC,CAAP;AACH,G;;;;SAOqBY,uB;;;AAKtB;AACA;AACA;AACA;AACA;;;;+CATO,WAAuCrB,QAAvC,EAAmG;AAAA,QAA1CS,OAA0C,uEAAvB,EAAuB;AACtG,QAAMD,IAAI,SAAST,cAAc,CAACC,QAAD,CAAjC;AACA,WAAOO,mBAAmB,CAACC,IAAD,EAAOC,OAAP,CAA1B;AACH,G;;;;SAOqBa,sB;;;;;8CAAf,WAAsCtB,QAAtC,EAAgG;AAAA,QAAxCS,OAAwC,uEAArB,EAAqB;AACnG,WAAO,OAAOY,uBAAuB,CAACrB,QAAD,EAAWS,OAAX,CAA9B,EAAmD,CAAnD,CAAP;AACH,G","sourceRoot":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/","sourcesContent":["import hdkey from '@herajs/hdkey';\nimport { constants } from '@herajs/common';\n\n// Re-export useful functions from bip39\nimport {\n    generateMnemonic as _generateMnemonic,\n    mnemonicToSeed as _mnemonicToSeed,\n    validateMnemonic,\n} from 'bip39';\n\nexport { validateMnemonic };\n\n/**\n * Generate random mnemonic\n * @param strength in bits, default 128\n * @param rng optional, function to generate random bots\n * @param wordlist optional, custom wordlist\n */\nexport function generateMnemonic(strength?: number, rng?: (size: number) => Buffer, wordlist?: string[]): string {\n    return _generateMnemonic(strength, rng, wordlist);\n}\n\n/**\n * Convert mnemonic string to seed\n * @param mnemonic\n * @param password optional\n */\nexport function mnemonicToSeed(mnemonic: string, password?: string): Promise<Buffer> {\n    return _mnemonicToSeed(mnemonic, password);\n}\n\n/**\n * Key derivation options\n */\nexport interface Options {\n    hdpath?: string;\n    count?: number;\n}\n\nconst defaultOptions = {\n    hdpath: constants.WALLET_HDPATH,\n    count: 1,\n};\n\n/**\n * Returns n private keys derived from seed\n * @param {Buffer} seed\n * @param {Options} options (optional) { count: number, hdpath: string }\n */\nexport function privateKeysFromSeed(seed: Buffer, options: Options = {}): Buffer[] {\n    const opts = { ...defaultOptions, ...options };\n    const hdwallet = hdkey.fromMasterSeed(seed);\n    const privateKeys = [];\n    for (let i = 0; i < opts.count; i++) {\n        const key = hdwallet.derive(opts.hdpath + i);\n        privateKeys.push(key.privateKey);\n    }\n    return privateKeys;\n}\n\n/**\n * Returns the first private key derived from seed\n * @param {Buffer} seed\n * @param {Options} options (optional) { hdpath: string }\n */\nexport async function privateKeyFromSeed(seed: Buffer, options: Options = {}): Promise<Buffer> {\n    return privateKeysFromSeed(seed, options)[0];\n}\n\n/**\n * Returns n private keys derived from mnemonic\n * @param {string} mnemonic\n * @param {Options} options (optional) { count: number, hdpath: string }\n */\nexport async function privateKeysFromMnemonic(mnemonic: string, options: Options = {}): Promise<Buffer[]> {\n    const seed = await mnemonicToSeed(mnemonic);\n    return privateKeysFromSeed(seed, options);\n}\n\n/**\n * Returns the first private key derived from mnemonic\n * @param {string} mnemonic\n * @param {Options} options (optional) { hdpath: string }\n */\nexport async function privateKeyFromMnemonic(mnemonic: string, options: Options = {}): Promise<Buffer> {\n    return (await privateKeysFromMnemonic(mnemonic, options))[0];\n}\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1a6be48475dad9b32c151ce2b0163645ee3f23af","contentHash":"78eec33a664a4e6f43364c5aa6fe3361dc551c0b53399dc50deec1fb9ca28ea7"},"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/keystore.ts":{"path":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/keystore.ts","statementMap":{"0":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":52}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":56}},"3":{"start":{"line":9,"column":14},"end":{"line":9,"column":31}},"4":{"start":{"line":11,"column":25},"end":{"line":11,"column":79}},"5":{"start":{"line":13,"column":17},"end":{"line":13,"column":40}},"6":{"start":{"line":15,"column":16},"end":{"line":15,"column":35}},"7":{"start":{"line":17,"column":12},"end":{"line":17,"column":29}},"8":{"start":{"line":19,"column":15},"end":{"line":19,"column":35}},"9":{"start":{"line":21,"column":39},"end":{"line":21,"column":95}},"10":{"start":{"line":23,"column":54},"end":{"line":23,"column":73}},"11":{"start":{"line":23,"column":75},"end":{"line":23,"column":326}},"12":{"start":{"line":23,"column":125},"end":{"line":23,"column":161}},"13":{"start":{"line":23,"column":163},"end":{"line":23,"column":324}},"14":{"start":{"line":23,"column":224},"end":{"line":23,"column":287}},"15":{"start":{"line":23,"column":327},"end":{"line":23,"column":339}},"16":{"start":{"line":25,"column":33},"end":{"line":25,"column":489}},"17":{"start":{"line":25,"column":46},"end":{"line":25,"column":47}},"18":{"start":{"line":25,"column":91},"end":{"line":25,"column":131}},"19":{"start":{"line":25,"column":133},"end":{"line":25,"column":487}},"20":{"start":{"line":25,"column":194},"end":{"line":25,"column":236}},"21":{"start":{"line":25,"column":402},"end":{"line":25,"column":483}},"22":{"start":{"line":25,"column":490},"end":{"line":25,"column":504}},"23":{"start":{"line":27,"column":44},"end":{"line":27,"column":195}},"24":{"start":{"line":27,"column":62},"end":{"line":27,"column":166}},"25":{"start":{"line":27,"column":176},"end":{"line":27,"column":193}},"26":{"start":{"line":27,"column":196},"end":{"line":27,"column":207}},"27":{"start":{"line":29,"column":34},"end":{"line":29,"column":156}},"28":{"start":{"line":31,"column":30},"end":{"line":31,"column":191}},"29":{"start":{"line":33,"column":50},"end":{"line":33,"column":65}},"30":{"start":{"line":33,"column":58},"end":{"line":33,"column":65}},"31":{"start":{"line":33,"column":66},"end":{"line":33,"column":129}},"32":{"start":{"line":33,"column":93},"end":{"line":33,"column":129}},"33":{"start":{"line":33,"column":138},"end":{"line":33,"column":184}},"34":{"start":{"line":33,"column":186},"end":{"line":33,"column":246}},"35":{"start":{"line":33,"column":223},"end":{"line":33,"column":246}},"36":{"start":{"line":33,"column":247},"end":{"line":33,"column":300}},"37":{"start":{"line":33,"column":279},"end":{"line":33,"column":300}},"38":{"start":{"line":33,"column":301},"end":{"line":33,"column":414}},"39":{"start":{"line":33,"column":378},"end":{"line":33,"column":414}},"40":{"start":{"line":35,"column":39},"end":{"line":35,"column":93}},"41":{"start":{"line":35,"column":76},"end":{"line":35,"column":93}},"42":{"start":{"line":35,"column":94},"end":{"line":35,"column":168}},"43":{"start":{"line":35,"column":107},"end":{"line":35,"column":108}},"44":{"start":{"line":35,"column":117},"end":{"line":35,"column":131}},"45":{"start":{"line":35,"column":149},"end":{"line":35,"column":166}},"46":{"start":{"line":35,"column":169},"end":{"line":35,"column":181}},"47":{"start":{"line":37,"column":50},"end":{"line":37,"column":145}},"48":{"start":{"line":37,"column":147},"end":{"line":37,"column":170}},"49":{"start":{"line":37,"column":163},"end":{"line":37,"column":170}},"50":{"start":{"line":37,"column":182},"end":{"line":37,"column":184}},"51":{"start":{"line":37,"column":195},"end":{"line":37,"column":199}},"52":{"start":{"line":37,"column":210},"end":{"line":37,"column":215}},"53":{"start":{"line":37,"column":229},"end":{"line":37,"column":498}},"54":{"start":{"line":37,"column":235},"end":{"line":37,"column":360}},"55":{"start":{"line":37,"column":303},"end":{"line":37,"column":323}},"56":{"start":{"line":37,"column":324},"end":{"line":37,"column":358}},"57":{"start":{"line":37,"column":352},"end":{"line":37,"column":358}},"58":{"start":{"line":37,"column":377},"end":{"line":37,"column":387}},"59":{"start":{"line":37,"column":388},"end":{"line":37,"column":397}},"60":{"start":{"line":37,"column":410},"end":{"line":37,"column":496}},"61":{"start":{"line":37,"column":416},"end":{"line":37,"column":464}},"62":{"start":{"line":37,"column":449},"end":{"line":37,"column":464}},"63":{"start":{"line":37,"column":477},"end":{"line":37,"column":494}},"64":{"start":{"line":37,"column":485},"end":{"line":37,"column":494}},"65":{"start":{"line":37,"column":499},"end":{"line":37,"column":511}},"66":{"start":{"line":39,"column":32},"end":{"line":39,"column":67}},"67":{"start":{"line":39,"column":56},"end":{"line":39,"column":67}},"68":{"start":{"line":41,"column":77},"end":{"line":41,"column":175}},"69":{"start":{"line":41,"column":94},"end":{"line":41,"column":107}},"70":{"start":{"line":41,"column":121},"end":{"line":41,"column":131}},"71":{"start":{"line":41,"column":151},"end":{"line":41,"column":165}},"72":{"start":{"line":41,"column":166},"end":{"line":41,"column":173}},"73":{"start":{"line":41,"column":176},"end":{"line":41,"column":263}},"74":{"start":{"line":41,"column":193},"end":{"line":41,"column":208}},"75":{"start":{"line":41,"column":218},"end":{"line":41,"column":261}},"76":{"start":{"line":43,"column":33},"end":{"line":43,"column":387}},"77":{"start":{"line":43,"column":65},"end":{"line":43,"column":69}},"78":{"start":{"line":43,"column":78},"end":{"line":43,"column":87}},"79":{"start":{"line":43,"column":89},"end":{"line":43,"column":384}},"80":{"start":{"line":43,"column":147},"end":{"line":43,"column":167}},"81":{"start":{"line":43,"column":193},"end":{"line":43,"column":264}},"82":{"start":{"line":43,"column":290},"end":{"line":43,"column":360}},"83":{"start":{"line":43,"column":363},"end":{"line":43,"column":380}},"84":{"start":{"line":45,"column":15},"end":{"line":55,"column":1}},"85":{"start":{"line":58,"column":15},"end":{"line":58,"column":76}},"86":{"start":{"line":60,"column":2},"end":{"line":60,"column":36}},"87":{"start":{"line":64,"column":2},"end":{"line":64,"column":49}},"88":{"start":{"line":68,"column":2},"end":{"line":88,"column":5}},"89":{"start":{"line":69,"column":4},"end":{"line":71,"column":5}},"90":{"start":{"line":70,"column":6},"end":{"line":70,"column":75}},"91":{"start":{"line":73,"column":4},"end":{"line":75,"column":5}},"92":{"start":{"line":74,"column":6},"end":{"line":74,"column":62}},"93":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"94":{"start":{"line":78,"column":6},"end":{"line":78,"column":62}},"95":{"start":{"line":81,"column":4},"end":{"line":87,"column":8}},"96":{"start":{"line":89,"column":2},"end":{"line":89,"column":49}},"97":{"start":{"line":93,"column":2},"end":{"line":93,"column":41}},"98":{"start":{"line":97,"column":2},"end":{"line":113,"column":5}},"99":{"start":{"line":98,"column":21},"end":{"line":98,"column":57}},"100":{"start":{"line":100,"column":16},"end":{"line":100,"column":60}},"101":{"start":{"line":102,"column":21},"end":{"line":102,"column":66}},"102":{"start":{"line":104,"column":14},"end":{"line":104,"column":49}},"103":{"start":{"line":106,"column":4},"end":{"line":108,"column":5}},"104":{"start":{"line":107,"column":6},"end":{"line":107,"column":85}},"105":{"start":{"line":110,"column":14},"end":{"line":110,"column":105}},"106":{"start":{"line":112,"column":4},"end":{"line":112,"column":22}},"107":{"start":{"line":114,"column":2},"end":{"line":114,"column":41}},"108":{"start":{"line":118,"column":2},"end":{"line":118,"column":41}},"109":{"start":{"line":133,"column":2},"end":{"line":140,"column":5}},"110":{"start":{"line":134,"column":21},"end":{"line":134,"column":57}},"111":{"start":{"line":136,"column":21},"end":{"line":136,"column":105}},"112":{"start":{"line":138,"column":14},"end":{"line":138,"column":49}},"113":{"start":{"line":139,"column":4},"end":{"line":139,"column":29}},"114":{"start":{"line":141,"column":2},"end":{"line":141,"column":41}},"115":{"start":{"line":145,"column":2},"end":{"line":145,"column":54}},"116":{"start":{"line":160,"column":2},"end":{"line":177,"column":5}},"117":{"start":{"line":161,"column":4},"end":{"line":163,"column":5}},"118":{"start":{"line":162,"column":6},"end":{"line":162,"column":84}},"119":{"start":{"line":165,"column":25},"end":{"line":165,"column":79}},"120":{"start":{"line":166,"column":26},"end":{"line":166,"column":59}},"121":{"start":{"line":167,"column":21},"end":{"line":167,"column":39}},"122":{"start":{"line":168,"column":22},"end":{"line":168,"column":40}},"123":{"start":{"line":170,"column":14},"end":{"line":170,"column":58}},"124":{"start":{"line":172,"column":4},"end":{"line":174,"column":5}},"125":{"start":{"line":173,"column":6},"end":{"line":173,"column":43}},"126":{"start":{"line":176,"column":4},"end":{"line":176,"column":57}},"127":{"start":{"line":178,"column":2},"end":{"line":178,"column":54}},"128":{"start":{"line":182,"column":2},"end":{"line":182,"column":56}},"129":{"start":{"line":186,"column":2},"end":{"line":219,"column":5}},"130":{"start":{"line":187,"column":19},"end":{"line":187,"column":57}},"131":{"start":{"line":189,"column":16},"end":{"line":189,"column":60}},"132":{"start":{"line":191,"column":14},"end":{"line":197,"column":5}},"133":{"start":{"line":199,"column":25},"end":{"line":199,"column":65}},"134":{"start":{"line":200,"column":26},"end":{"line":200,"column":59}},"135":{"start":{"line":201,"column":21},"end":{"line":201,"column":39}},"136":{"start":{"line":202,"column":14},"end":{"line":202,"column":32}},"137":{"start":{"line":204,"column":19},"end":{"line":217,"column":5}},"138":{"start":{"line":218,"column":4},"end":{"line":218,"column":20}},"139":{"start":{"line":220,"column":2},"end":{"line":220,"column":56}}},"fnMap":{"0":{"name":"_interopRequireDefault","decl":{"start":{"line":21,"column":9},"end":{"line":21,"column":31}},"loc":{"start":{"line":21,"column":37},"end":{"line":21,"column":97}},"line":21},"1":{"name":"ownKeys","decl":{"start":{"line":23,"column":9},"end":{"line":23,"column":16}},"loc":{"start":{"line":23,"column":41},"end":{"line":23,"column":341}},"line":23},"2":{"name":"(anonymous_2)","decl":{"start":{"line":23,"column":207},"end":{"line":23,"column":208}},"loc":{"start":{"line":23,"column":222},"end":{"line":23,"column":289}},"line":23},"3":{"name":"_objectSpread","decl":{"start":{"line":25,"column":9},"end":{"line":25,"column":22}},"loc":{"start":{"line":25,"column":31},"end":{"line":25,"column":506}},"line":25},"4":{"name":"(anonymous_4)","decl":{"start":{"line":25,"column":177},"end":{"line":25,"column":178}},"loc":{"start":{"line":25,"column":192},"end":{"line":25,"column":238}},"line":25},"5":{"name":"(anonymous_5)","decl":{"start":{"line":25,"column":385},"end":{"line":25,"column":386}},"loc":{"start":{"line":25,"column":400},"end":{"line":25,"column":485}},"line":25},"6":{"name":"_defineProperty","decl":{"start":{"line":27,"column":9},"end":{"line":27,"column":24}},"loc":{"start":{"line":27,"column":42},"end":{"line":27,"column":209}},"line":27},"7":{"name":"_slicedToArray","decl":{"start":{"line":29,"column":9},"end":{"line":29,"column":23}},"loc":{"start":{"line":29,"column":32},"end":{"line":29,"column":158}},"line":29},"8":{"name":"_nonIterableRest","decl":{"start":{"line":31,"column":9},"end":{"line":31,"column":25}},"loc":{"start":{"line":31,"column":28},"end":{"line":31,"column":193}},"line":31},"9":{"name":"_unsupportedIterableToArray","decl":{"start":{"line":33,"column":9},"end":{"line":33,"column":36}},"loc":{"start":{"line":33,"column":48},"end":{"line":33,"column":416}},"line":33},"10":{"name":"_arrayLikeToArray","decl":{"start":{"line":35,"column":9},"end":{"line":35,"column":26}},"loc":{"start":{"line":35,"column":37},"end":{"line":35,"column":183}},"line":35},"11":{"name":"_iterableToArrayLimit","decl":{"start":{"line":37,"column":9},"end":{"line":37,"column":30}},"loc":{"start":{"line":37,"column":39},"end":{"line":37,"column":513}},"line":37},"12":{"name":"_arrayWithHoles","decl":{"start":{"line":39,"column":9},"end":{"line":39,"column":24}},"loc":{"start":{"line":39,"column":30},"end":{"line":39,"column":69}},"line":39},"13":{"name":"asyncGeneratorStep","decl":{"start":{"line":41,"column":9},"end":{"line":41,"column":27}},"loc":{"start":{"line":41,"column":75},"end":{"line":41,"column":265}},"line":41},"14":{"name":"_asyncToGenerator","decl":{"start":{"line":43,"column":9},"end":{"line":43,"column":26}},"loc":{"start":{"line":43,"column":31},"end":{"line":43,"column":389}},"line":43},"15":{"name":"(anonymous_15)","decl":{"start":{"line":43,"column":40},"end":{"line":43,"column":41}},"loc":{"start":{"line":43,"column":52},"end":{"line":43,"column":386}},"line":43},"16":{"name":"(anonymous_16)","decl":{"start":{"line":43,"column":108},"end":{"line":43,"column":109}},"loc":{"start":{"line":43,"column":135},"end":{"line":43,"column":382}},"line":43},"17":{"name":"_next","decl":{"start":{"line":43,"column":178},"end":{"line":43,"column":183}},"loc":{"start":{"line":43,"column":191},"end":{"line":43,"column":266}},"line":43},"18":{"name":"_throw","decl":{"start":{"line":43,"column":276},"end":{"line":43,"column":282}},"loc":{"start":{"line":43,"column":288},"end":{"line":43,"column":362}},"line":43},"19":{"name":"generateMac","decl":{"start":{"line":57,"column":9},"end":{"line":57,"column":20}},"loc":{"start":{"line":57,"column":45},"end":{"line":61,"column":1}},"line":57},"20":{"name":"deriveCipherKey","decl":{"start":{"line":63,"column":9},"end":{"line":63,"column":24}},"loc":{"start":{"line":63,"column":34},"end":{"line":65,"column":1}},"line":63},"21":{"name":"_deriveCipherKey","decl":{"start":{"line":67,"column":9},"end":{"line":67,"column":25}},"loc":{"start":{"line":67,"column":28},"end":{"line":90,"column":1}},"line":67},"22":{"name":"(anonymous_22)","decl":{"start":{"line":68,"column":39},"end":{"line":68,"column":40}},"loc":{"start":{"line":68,"column":65},"end":{"line":88,"column":3}},"line":68},"23":{"name":"decrypt","decl":{"start":{"line":92,"column":9},"end":{"line":92,"column":16}},"loc":{"start":{"line":92,"column":32},"end":{"line":94,"column":1}},"line":92},"24":{"name":"_decrypt","decl":{"start":{"line":96,"column":9},"end":{"line":96,"column":17}},"loc":{"start":{"line":96,"column":20},"end":{"line":115,"column":1}},"line":96},"25":{"name":"(anonymous_25)","decl":{"start":{"line":97,"column":31},"end":{"line":97,"column":32}},"loc":{"start":{"line":97,"column":65},"end":{"line":113,"column":3}},"line":97},"26":{"name":"encrypt","decl":{"start":{"line":117,"column":9},"end":{"line":117,"column":16}},"loc":{"start":{"line":117,"column":37},"end":{"line":119,"column":1}},"line":117},"27":{"name":"_encrypt","decl":{"start":{"line":132,"column":9},"end":{"line":132,"column":17}},"loc":{"start":{"line":132,"column":20},"end":{"line":142,"column":1}},"line":132},"28":{"name":"(anonymous_28)","decl":{"start":{"line":133,"column":31},"end":{"line":133,"column":32}},"loc":{"start":{"line":133,"column":69},"end":{"line":140,"column":3}},"line":133},"29":{"name":"identityFromKeystore","decl":{"start":{"line":144,"column":9},"end":{"line":144,"column":29}},"loc":{"start":{"line":144,"column":42},"end":{"line":146,"column":1}},"line":144},"30":{"name":"_identityFromKeystore","decl":{"start":{"line":159,"column":9},"end":{"line":159,"column":30}},"loc":{"start":{"line":159,"column":33},"end":{"line":179,"column":1}},"line":159},"31":{"name":"(anonymous_31)","decl":{"start":{"line":160,"column":44},"end":{"line":160,"column":45}},"loc":{"start":{"line":160,"column":75},"end":{"line":177,"column":3}},"line":160},"32":{"name":"keystoreFromPrivateKey","decl":{"start":{"line":181,"column":9},"end":{"line":181,"column":31}},"loc":{"start":{"line":181,"column":50},"end":{"line":183,"column":1}},"line":181},"33":{"name":"_keystoreFromPrivateKey","decl":{"start":{"line":185,"column":9},"end":{"line":185,"column":32}},"loc":{"start":{"line":185,"column":35},"end":{"line":221,"column":1}},"line":185},"34":{"name":"(anonymous_34)","decl":{"start":{"line":186,"column":46},"end":{"line":186,"column":47}},"loc":{"start":{"line":186,"column":83},"end":{"line":219,"column":3}},"line":186}},"branchMap":{"0":{"loc":{"start":{"line":21,"column":46},"end":{"line":21,"column":94}},"type":"cond-expr","locations":[{"start":{"line":21,"column":70},"end":{"line":21,"column":73}},{"start":{"line":21,"column":76},"end":{"line":21,"column":94}}],"line":21},"1":{"loc":{"start":{"line":21,"column":46},"end":{"line":21,"column":67}},"type":"binary-expr","locations":[{"start":{"line":21,"column":46},"end":{"line":21,"column":49}},{"start":{"line":21,"column":53},"end":{"line":21,"column":67}}],"line":21},"2":{"loc":{"start":{"line":23,"column":75},"end":{"line":23,"column":326}},"type":"if","locations":[{"start":{"line":23,"column":75},"end":{"line":23,"column":326}},{"start":{"line":23,"column":75},"end":{"line":23,"column":326}}],"line":23},"3":{"loc":{"start":{"line":23,"column":163},"end":{"line":23,"column":291}},"type":"binary-expr","locations":[{"start":{"line":23,"column":163},"end":{"line":23,"column":177}},{"start":{"line":23,"column":182},"end":{"line":23,"column":290}}],"line":23},"4":{"loc":{"start":{"line":25,"column":91},"end":{"line":25,"column":131}},"type":"cond-expr","locations":[{"start":{"line":25,"column":114},"end":{"line":25,"column":126}},{"start":{"line":25,"column":129},"end":{"line":25,"column":131}}],"line":25},"5":{"loc":{"start":{"line":25,"column":133},"end":{"line":25,"column":486}},"type":"cond-expr","locations":[{"start":{"line":25,"column":141},"end":{"line":25,"column":239}},{"start":{"line":25,"column":242},"end":{"line":25,"column":486}}],"line":25},"6":{"loc":{"start":{"line":25,"column":242},"end":{"line":25,"column":486}},"type":"cond-expr","locations":[{"start":{"line":25,"column":277},"end":{"line":25,"column":350}},{"start":{"line":25,"column":353},"end":{"line":25,"column":486}}],"line":25},"7":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":195}},"type":"if","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":195}},{"start":{"line":27,"column":44},"end":{"line":27,"column":195}}],"line":27},"8":{"loc":{"start":{"line":29,"column":41},"end":{"line":29,"column":155}},"type":"binary-expr","locations":[{"start":{"line":29,"column":41},"end":{"line":29,"column":61}},{"start":{"line":29,"column":65},"end":{"line":29,"column":94}},{"start":{"line":29,"column":98},"end":{"line":29,"column":133}},{"start":{"line":29,"column":137},"end":{"line":29,"column":155}}],"line":29},"9":{"loc":{"start":{"line":33,"column":50},"end":{"line":33,"column":65}},"type":"if","locations":[{"start":{"line":33,"column":50},"end":{"line":33,"column":65}},{"start":{"line":33,"column":50},"end":{"line":33,"column":65}}],"line":33},"10":{"loc":{"start":{"line":33,"column":66},"end":{"line":33,"column":129}},"type":"if","locations":[{"start":{"line":33,"column":66},"end":{"line":33,"column":129}},{"start":{"line":33,"column":66},"end":{"line":33,"column":129}}],"line":33},"11":{"loc":{"start":{"line":33,"column":186},"end":{"line":33,"column":246}},"type":"if","locations":[{"start":{"line":33,"column":186},"end":{"line":33,"column":246}},{"start":{"line":33,"column":186},"end":{"line":33,"column":246}}],"line":33},"12":{"loc":{"start":{"line":33,"column":190},"end":{"line":33,"column":221}},"type":"binary-expr","locations":[{"start":{"line":33,"column":190},"end":{"line":33,"column":204}},{"start":{"line":33,"column":208},"end":{"line":33,"column":221}}],"line":33},"13":{"loc":{"start":{"line":33,"column":247},"end":{"line":33,"column":300}},"type":"if","locations":[{"start":{"line":33,"column":247},"end":{"line":33,"column":300}},{"start":{"line":33,"column":247},"end":{"line":33,"column":300}}],"line":33},"14":{"loc":{"start":{"line":33,"column":251},"end":{"line":33,"column":277}},"type":"binary-expr","locations":[{"start":{"line":33,"column":251},"end":{"line":33,"column":262}},{"start":{"line":33,"column":266},"end":{"line":33,"column":277}}],"line":33},"15":{"loc":{"start":{"line":33,"column":301},"end":{"line":33,"column":414}},"type":"if","locations":[{"start":{"line":33,"column":301},"end":{"line":33,"column":414}},{"start":{"line":33,"column":301},"end":{"line":33,"column":414}}],"line":33},"16":{"loc":{"start":{"line":33,"column":305},"end":{"line":33,"column":376}},"type":"binary-expr","locations":[{"start":{"line":33,"column":305},"end":{"line":33,"column":322}},{"start":{"line":33,"column":326},"end":{"line":33,"column":376}}],"line":33},"17":{"loc":{"start":{"line":35,"column":39},"end":{"line":35,"column":93}},"type":"if","locations":[{"start":{"line":35,"column":39},"end":{"line":35,"column":93}},{"start":{"line":35,"column":39},"end":{"line":35,"column":93}}],"line":35},"18":{"loc":{"start":{"line":35,"column":43},"end":{"line":35,"column":74}},"type":"binary-expr","locations":[{"start":{"line":35,"column":43},"end":{"line":35,"column":54}},{"start":{"line":35,"column":58},"end":{"line":35,"column":74}}],"line":35},"19":{"loc":{"start":{"line":37,"column":50},"end":{"line":37,"column":145}},"type":"cond-expr","locations":[{"start":{"line":37,"column":64},"end":{"line":37,"column":68}},{"start":{"line":37,"column":71},"end":{"line":37,"column":145}}],"line":37},"20":{"loc":{"start":{"line":37,"column":71},"end":{"line":37,"column":145}},"type":"binary-expr","locations":[{"start":{"line":37,"column":71},"end":{"line":37,"column":100}},{"start":{"line":37,"column":104},"end":{"line":37,"column":124}},{"start":{"line":37,"column":128},"end":{"line":37,"column":145}}],"line":37},"21":{"loc":{"start":{"line":37,"column":147},"end":{"line":37,"column":170}},"type":"if","locations":[{"start":{"line":37,"column":147},"end":{"line":37,"column":170}},{"start":{"line":37,"column":147},"end":{"line":37,"column":170}}],"line":37},"22":{"loc":{"start":{"line":37,"column":324},"end":{"line":37,"column":358}},"type":"if","locations":[{"start":{"line":37,"column":324},"end":{"line":37,"column":358}},{"start":{"line":37,"column":324},"end":{"line":37,"column":358}}],"line":37},"23":{"loc":{"start":{"line":37,"column":328},"end":{"line":37,"column":350}},"type":"binary-expr","locations":[{"start":{"line":37,"column":328},"end":{"line":37,"column":329}},{"start":{"line":37,"column":333},"end":{"line":37,"column":350}}],"line":37},"24":{"loc":{"start":{"line":37,"column":416},"end":{"line":37,"column":464}},"type":"if","locations":[{"start":{"line":37,"column":416},"end":{"line":37,"column":464}},{"start":{"line":37,"column":416},"end":{"line":37,"column":464}}],"line":37},"25":{"loc":{"start":{"line":37,"column":420},"end":{"line":37,"column":447}},"type":"binary-expr","locations":[{"start":{"line":37,"column":420},"end":{"line":37,"column":423}},{"start":{"line":37,"column":427},"end":{"line":37,"column":447}}],"line":37},"26":{"loc":{"start":{"line":37,"column":477},"end":{"line":37,"column":494}},"type":"if","locations":[{"start":{"line":37,"column":477},"end":{"line":37,"column":494}},{"start":{"line":37,"column":477},"end":{"line":37,"column":494}}],"line":37},"27":{"loc":{"start":{"line":39,"column":32},"end":{"line":39,"column":67}},"type":"if","locations":[{"start":{"line":39,"column":32},"end":{"line":39,"column":67}},{"start":{"line":39,"column":32},"end":{"line":39,"column":67}}],"line":39},"28":{"loc":{"start":{"line":41,"column":176},"end":{"line":41,"column":263}},"type":"if","locations":[{"start":{"line":41,"column":176},"end":{"line":41,"column":263}},{"start":{"line":41,"column":176},"end":{"line":41,"column":263}}],"line":41},"29":{"loc":{"start":{"line":69,"column":4},"end":{"line":71,"column":5}},"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":71,"column":5}},{"start":{"line":69,"column":4},"end":{"line":71,"column":5}}],"line":69},"30":{"loc":{"start":{"line":73,"column":4},"end":{"line":75,"column":5}},"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":75,"column":5}},{"start":{"line":73,"column":4},"end":{"line":75,"column":5}}],"line":73},"31":{"loc":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},{"start":{"line":77,"column":4},"end":{"line":79,"column":5}}],"line":77},"32":{"loc":{"start":{"line":106,"column":4},"end":{"line":108,"column":5}},"type":"if","locations":[{"start":{"line":106,"column":4},"end":{"line":108,"column":5}},{"start":{"line":106,"column":4},"end":{"line":108,"column":5}}],"line":106},"33":{"loc":{"start":{"line":161,"column":4},"end":{"line":163,"column":5}},"type":"if","locations":[{"start":{"line":161,"column":4},"end":{"line":163,"column":5}},{"start":{"line":161,"column":4},"end":{"line":163,"column":5}}],"line":161},"34":{"loc":{"start":{"line":172,"column":4},"end":{"line":174,"column":5}},"type":"if","locations":[{"start":{"line":172,"column":4},"end":{"line":174,"column":5}},{"start":{"line":172,"column":4},"end":{"line":174,"column":5}}],"line":172},"35":{"loc":{"start":{"line":195,"column":14},"end":{"line":195,"column":144}},"type":"cond-expr","locations":[{"start":{"line":195,"column":67},"end":{"line":195,"column":81}},{"start":{"line":195,"column":84},"end":{"line":195,"column":144}}],"line":195},"36":{"loc":{"start":{"line":195,"column":14},"end":{"line":195,"column":64}},"type":"binary-expr","locations":[{"start":{"line":195,"column":14},"end":{"line":195,"column":23}},{"start":{"line":195,"column":27},"end":{"line":195,"column":64}}],"line":195}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":5,"11":5,"12":5,"13":5,"14":0,"15":5,"16":3,"17":3,"18":10,"19":10,"20":13,"21":0,"22":3,"23":13,"24":1,"25":12,"26":13,"27":4,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":4,"67":4,"68":51,"69":51,"70":35,"71":16,"72":16,"73":35,"74":12,"75":23,"76":5,"77":28,"78":28,"79":28,"80":28,"81":42,"82":9,"83":28,"84":1,"85":5,"86":5,"87":9,"88":1,"89":9,"90":1,"91":8,"92":1,"93":7,"94":2,"95":5,"96":1,"97":7,"98":1,"99":7,"100":4,"101":4,"102":4,"103":4,"104":1,"105":3,"106":3,"107":1,"108":2,"109":1,"110":2,"111":1,"112":1,"113":1,"114":1,"115":8,"116":1,"117":8,"118":1,"119":7,"120":3,"121":3,"122":3,"123":3,"124":3,"125":1,"126":2,"127":1,"128":2,"129":1,"130":2,"131":2,"132":2,"133":2,"134":1,"135":1,"136":1,"137":1,"138":1,"139":1},"f":{"0":1,"1":5,"2":0,"3":3,"4":13,"5":0,"6":13,"7":4,"8":0,"9":0,"10":0,"11":0,"12":4,"13":51,"14":5,"15":28,"16":28,"17":42,"18":9,"19":5,"20":9,"21":1,"22":9,"23":7,"24":1,"25":7,"26":2,"27":1,"28":2,"29":8,"30":1,"31":8,"32":2,"33":1,"34":2},"b":{"0":[1,0],"1":[1,1],"2":[5,0],"3":[5,5],"4":[10,0],"5":[5,5],"6":[5,0],"7":[1,12],"8":[4,0,0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[4,0],"28":[12,23],"29":[1,8],"30":[1,7],"31":[2,5],"32":[1,3],"33":[1,7],"34":[1,2],"35":[1,1],"36":[2,2]},"inputSourceMap":{"version":3,"sources":["keystore.ts"],"names":["DEFAULTS","version","kdfAlgorithm","cipherAlgorithm","kdfParams","dklen","n","p","r","generateMac","derivedKey","cipherText","rawMac","Buffer","concat","slice","deriveCipherKey","kdf","password","algorithm","Error","params","salt","from","N","dkLen","encoding","decrypt","cipher","decryptKey","nonce","iv","ciphertext","mac","key","AES_CTR","encrypt","identityFromKeystore","keystore","ks_version","privateKey","expectedMac","equals","keystoreFromPrivateKey","identity","toString","address"],"mappings":";;;;;;;;AAAA;;AAEA;;AACA;;AACA;;AAEA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA,IAAMA,QAAQ,GAAG;AACbC,EAAAA,OAAO,EAAE,GADI;AAEbC,EAAAA,YAAY,EAAE,QAFD;AAGbC,EAAAA,eAAe,EAAE,aAHJ;AAIbC,EAAAA,SAAS,EAAE;AACPC,IAAAA,KAAK,EAAE,EADA;AAEPC,IAAAA,CAAC,EAAE,KAAK,EAFD;AAGPC,IAAAA,CAAC,EAAE,CAHI;AAIPC,IAAAA,CAAC,EAAE;AAJI;AAJE,CAAjB;;AAYA,SAASC,WAAT,CAAqBC,UAArB,EAAyCC,UAAzC,EAAqE;AACjE,MAAMC,MAAc,GAAGC,eAAOC,MAAP,CAAc,CAACJ,UAAU,CAACK,KAAX,CAAiB,EAAjB,EAAqB,EAArB,CAAD,EAA2BJ,UAA3B,CAAd,CAAvB;;AACA,SAAO,mBAAKC,MAAL,CAAP;AACH;;SAEcI,e;;;;;uCAAf,WAA+BC,GAA/B,EAAiDC,QAAjD,EAAoF;AAChF,QAAID,GAAG,CAACE,SAAJ,KAAkB,QAAtB,EAAgC;AAC5B,YAAM,IAAIC,KAAJ,sCAAwCH,GAAG,CAACE,SAA5C,EAAN;AACH;;AACD,QAAI,CAACF,GAAG,CAACI,MAAJ,CAAWC,IAAhB,EAAsB;AAClB,YAAM,IAAIF,KAAJ,CAAU,sCAAV,CAAN;AACH;;AACD,QAAI,CAACF,QAAL,EAAe;AACX,YAAM,IAAIE,KAAJ,CAAU,sCAAV,CAAN;AACH;;AACD,WAAOP,eAAOU,IAAP,OAAkB,mCAAOV,eAAOU,IAAP,CAAYL,QAAZ,CAAP,EAA8BL,eAAOU,IAAP,CAAYN,GAAG,CAACI,MAAJ,CAAWC,IAAvB,EAA6B,KAA7B,CAA9B,EAAmE;AACxFE,MAAAA,CAAC,EAAEP,GAAG,CAACI,MAAJ,CAAWf,CAD0E;AAExFE,MAAAA,CAAC,EAAES,GAAG,CAACI,MAAJ,CAAWb,CAF0E;AAGxFD,MAAAA,CAAC,EAAEU,GAAG,CAACI,MAAJ,CAAWd,CAH0E;AAIxFkB,MAAAA,KAAK,EAAER,GAAG,CAACI,MAAJ,CAAWhB,KAJsE;AAKxFqB,MAAAA,QAAQ,EAAE;AAL8E,KAAnE,CAAlB,CAAP;AAOH,G;;;;SAEcC,O;;;;;+BAAf,WAAuBV,GAAvB,EAAyCW,MAAzC,EAAiEV,QAAjE,EAA8G;AAC1G,QAAMW,UAAU,SAASb,eAAe,CAACC,GAAD,EAAMC,QAAN,CAAxC;;AACA,QAAMY,KAAK,GAAGjB,eAAOU,IAAP,CAAYK,MAAM,CAACP,MAAP,CAAcU,EAA1B,EAA8B,KAA9B,CAAd;;AACA,QAAMC,UAAU,GAAGnB,eAAOU,IAAP,CAAYK,MAAM,CAACI,UAAnB,EAA+B,KAA/B,CAAnB;;AACA,QAAMC,GAAG,GAAGxB,WAAW,CAACoB,UAAD,EAAaG,UAAb,CAAvB;;AACA,QAAIJ,MAAM,CAACT,SAAP,KAAqB,aAAzB,EAAwC;AACpC,YAAM,IAAIC,KAAJ,6CAA+CQ,MAAM,CAACT,SAAtD,EAAN;AACH;;AACD,QAAMe,GAAG,GAAGrB,eAAOU,IAAP,CAAYY,mBAAQR,OAAR,CAAgBK,UAAhB,EAA4BH,UAAU,CAACd,KAAX,CAAiB,CAAjB,EAAoB,EAApB,CAA5B,EAAqDe,KAArD,CAAZ,CAAZ;;AACA,WAAO,CAACI,GAAD,EAAMD,GAAN,CAAP;AACH,G;;;;SAEcG,O;;;AAOf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;+BAhBA,WAAuBnB,GAAvB,EAAyCiB,GAAzC,EAAsDJ,KAAtD,EAAqEZ,QAArE,EAAkH;AAC9G,QAAMW,UAAU,SAASb,eAAe,CAACC,GAAD,EAAMC,QAAN,CAAxC;;AACA,QAAMc,UAAU,GAAGnB,eAAOU,IAAP,CAAYY,mBAAQC,OAAR,CAAgBF,GAAhB,EAAqBL,UAAU,CAACd,KAAX,CAAiB,CAAjB,EAAoB,EAApB,CAArB,EAA8Ce,KAA9C,CAAZ,CAAnB;;AACA,QAAMG,GAAG,GAAGxB,WAAW,CAACoB,UAAD,EAAaG,UAAb,CAAvB;AACA,WAAO,CAACA,UAAD,EAAaC,GAAb,CAAP;AACH,G;;;;SAYqBI,oB;;;AAYtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;4CArBO,WAAoCC,QAApC,EAAwDpB,QAAxD,EAA6F;AAChG,QAAIoB,QAAQ,CAACC,UAAT,KAAwB,GAA5B,EAAiC;AAC7B,YAAM,IAAInB,KAAJ,yCAA2CkB,QAAQ,CAACC,UAApD,EAAN;AACH;;AACD,+BAAwCZ,OAAO,CAACW,QAAQ,CAACrB,GAAV,EAAeqB,QAAQ,CAACV,MAAxB,EAAgCV,QAAhC,CAA/C;AAAA;AAAA,QAAOsB,UAAP;AAAA,QAAmBC,WAAnB;;AACA,QAAMR,GAAG,GAAGpB,eAAOU,IAAP,CAAYe,QAAQ,CAACrB,GAAT,CAAagB,GAAzB,EAA8B,KAA9B,CAAZ;;AACA,QAAI,CAACQ,WAAW,CAACC,MAAZ,CAAmB7B,eAAOU,IAAP,CAAYU,GAAZ,CAAnB,CAAL,EAA2C;AACvC,YAAM,IAAIb,KAAJ,CAAU,mBAAV,CAAN;AACH;;AACD,WAAO,kCAAuBoB,UAAvB,CAAP;AACH,G;;;;SAYqBG,sB;;;;;8CAAf,WAAsCT,GAAtC,EAAmDhB,QAAnD,EAAqEd,SAArE,EAA2H;AAC9H,QAAMwC,QAAQ,GAAG,kCAAuBV,GAAvB,CAAjB;;AACA,QAAMJ,KAAK,GAAGjB,eAAOU,IAAP,CAAY,oBAAK,EAAL,CAAZ,CAAd;;AACA,QAAMN,GAAgB,GAAG;AACrBE,MAAAA,SAAS,EAAEnB,QAAQ,CAACE,YADC;AAErB+B,MAAAA,GAAG,EAAE,EAFgB;AAGrBZ,MAAAA,MAAM,oBACCrB,QAAQ,CAACI,SADV,MAECA,SAFD;AAGFkB,QAAAA,IAAI,EAAElB,SAAS,IAAI,OAAOA,SAAS,CAACkB,IAAjB,KAA0B,WAAvC,GAAqDlB,SAAS,CAACkB,IAA/D,GAAsET,eAAOU,IAAP,CAAY,oBAAK,EAAL,CAAZ,EAAsBsB,QAAtB,CAA+B,KAA/B;AAH1E;AAHe,KAAzB;;AASA,+BAAgCT,OAAO,CAACnB,GAAD,EAAMiB,GAAN,EAAWJ,KAAX,EAAkBZ,QAAlB,CAAvC;AAAA;AAAA,QAAOc,UAAP;AAAA,QAAmBC,GAAnB;;AACA,QAAMK,QAAkB,GAAG;AACvBrB,MAAAA,GAAG,oBACIA,GADJ;AAECgB,QAAAA,GAAG,EAAEA,GAAG,CAACY,QAAJ,CAAa,KAAb;AAFN,QADoB;AAKvB,uBAAiBD,QAAQ,CAACE,OALH;AAMvB,oBAAc9C,QAAQ,CAACC,OANA;AAOvB2B,MAAAA,MAAM,EAAE;AACJT,QAAAA,SAAS,EAAEnB,QAAQ,CAACG,eADhB;AAEJ6B,QAAAA,UAAU,EAAEA,UAAU,CAACa,QAAX,CAAoB,KAApB,CAFR;AAGJxB,QAAAA,MAAM,EAAE;AACJU,UAAAA,EAAE,EAAED,KAAK,CAACe,QAAN,CAAe,KAAf;AADA;AAHJ;AAPe,KAA3B;AAeA,WAAOP,QAAP;AACH,G","sourceRoot":"/Users/paulgrau/projects/aergo/herajs/packages/crypto/src/","sourcesContent":["import { Buffer } from 'buffer';\n\nimport scrypt from 'scrypt-async-modern';\nimport { AES_CTR } from 'asmcrypto.js';\nimport { rand } from 'elliptic';\n\nimport { Identity, identityFromPrivateKey } from './keys';\nimport { hash } from './hashing';\n\ntype HexString = string;\n\ntype CipherAlgorithm = 'aes-128-ctr';\ntype KdfAlgorithm = 'scrypt';\ntype Version = '1';\n\ninterface CipherParams {\n    iv: HexString;\n}\ninterface KeystoreCipher {\n    algorithm: CipherAlgorithm;\n    params: CipherParams;\n    ciphertext: HexString;\n}\n\ninterface ScryptParams {\n    dklen: number;\n    n: number;\n    p: number;\n    r: number;\n    salt?: HexString;\n}\n\ninterface KeystoreKdf {\n    algorithm: 'scrypt';\n    params: ScryptParams;\n    mac: HexString;\n}\n\ninterface Keystore {\n    aergo_address: string;\n    ks_version: Version;\n    cipher: KeystoreCipher;\n    kdf: KeystoreKdf;\n}\n\nconst DEFAULTS = {\n    version: '1' as Version,\n    kdfAlgorithm: 'scrypt' as KdfAlgorithm,\n    cipherAlgorithm: 'aes-128-ctr' as CipherAlgorithm,\n    kdfParams: {\n        dklen: 32,\n        n: 1 << 18,\n        p: 1,\n        r: 8,\n    },\n};\n\nfunction generateMac(derivedKey: Buffer, cipherText: Buffer): Buffer {\n    const rawMac: Buffer = Buffer.concat([derivedKey.slice(16, 32), cipherText]);\n    return hash(rawMac);\n}\n\nasync function deriveCipherKey(kdf: KeystoreKdf, password: string): Promise<Buffer> {\n    if (kdf.algorithm !== 'scrypt') {\n        throw new Error(`unsupported kdf algorithm: ${kdf.algorithm}`);\n    }\n    if (!kdf.params.salt) {\n        throw new Error('missing required kdf parameter: salt');\n    }\n    if (!password) {\n        throw new Error('missing required parameter: password');\n    }\n    return Buffer.from(await scrypt(Buffer.from(password), Buffer.from(kdf.params.salt, 'hex'), {\n        N: kdf.params.n,\n        r: kdf.params.r,\n        p: kdf.params.p,\n        dkLen: kdf.params.dklen,\n        encoding: 'binary',\n    }));\n}\n\nasync function decrypt(kdf: KeystoreKdf, cipher: KeystoreCipher, password: string): Promise<[Buffer, Buffer]> {\n    const decryptKey = await deriveCipherKey(kdf, password);\n    const nonce = Buffer.from(cipher.params.iv, 'hex');\n    const ciphertext = Buffer.from(cipher.ciphertext, 'hex');\n    const mac = generateMac(decryptKey, ciphertext);\n    if (cipher.algorithm !== 'aes-128-ctr') {\n        throw new Error(`unsupported encryption algorithm: ${cipher.algorithm}`);\n    }\n    const key = Buffer.from(AES_CTR.decrypt(ciphertext, decryptKey.slice(0, 16), nonce));\n    return [key, mac];\n}\n\nasync function encrypt(kdf: KeystoreKdf, key: Buffer, nonce: Buffer, password: string): Promise<[Buffer, Buffer]> {\n    const decryptKey = await deriveCipherKey(kdf, password);\n    const ciphertext = Buffer.from(AES_CTR.encrypt(key, decryptKey.slice(0, 16), nonce));\n    const mac = generateMac(decryptKey, ciphertext);\n    return [ciphertext, mac];\n}\n\n/**\n * Decrypt keystore and return identity information.\n * \n * .. code-block:: javascript\n * \n *     import { identityFromKeystore } from '@herajs/crypto';\n *     const keystore = JSON.parse('keystore file contents');\n *     const identity = await identityFromKeystore(keystore, 'password');\n *     console.log(identity);\n */\nexport async function identityFromKeystore(keystore: Keystore, password: string): Promise<Identity> {\n    if (keystore.ks_version !== '1') {\n        throw new Error(`unsupported keystore version: ${keystore.ks_version}`);\n    }\n    const [privateKey, expectedMac] = await decrypt(keystore.kdf, keystore.cipher, password);\n    const mac = Buffer.from(keystore.kdf.mac, 'hex');\n    if (!expectedMac.equals(Buffer.from(mac))) {\n        throw new Error('invalid mac value');\n    }\n    return identityFromPrivateKey(privateKey);\n}\n\n/**\n * Encrypt private key and return keystore data.\n * \n * .. code-block:: javascript\n * \n *     import { keystoreFromPrivateKey, createIdentity } from '@herajs/crypto';\n *     const identity = createIdentity();\n *     const keystore = await keystoreFromPrivateKey(identity.privateKey, 'password');\n *     console.log(JSON.stringify(keystore, null, 2));\n */\nexport async function keystoreFromPrivateKey(key: Buffer, password: string, kdfParams?: Partial<ScryptParams>): Promise<Keystore> {\n    const identity = identityFromPrivateKey(key);\n    const nonce = Buffer.from(rand(16));\n    const kdf: KeystoreKdf = {\n        algorithm: DEFAULTS.kdfAlgorithm,\n        mac: '',\n        params: {\n            ...DEFAULTS.kdfParams,\n            ...kdfParams,\n            salt: kdfParams && typeof kdfParams.salt !== 'undefined' ? kdfParams.salt : Buffer.from(rand(32)).toString('hex'),\n        },\n    };\n    const [ciphertext, mac] = await encrypt(kdf, key, nonce, password);\n    const keystore: Keystore = {\n        kdf: {\n            ...kdf,\n            mac: mac.toString('hex'),\n        },\n        'aergo_address': identity.address,\n        'ks_version': DEFAULTS.version,\n        cipher: {\n            algorithm: DEFAULTS.cipherAlgorithm,\n            ciphertext: ciphertext.toString('hex'),\n            params: {\n                iv: nonce.toString('hex'),\n            }\n        }\n    };\n    return keystore;\n}\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4c7bb6ea5df95af6a03aa9caf0e1b122f11206d4","contentHash":"e96d95ac263372274a664ed2de0712fa9aeeda246fc05d780b2075084f801e39"}}